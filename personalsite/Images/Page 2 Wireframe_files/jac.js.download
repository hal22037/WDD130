/*! JAC 1.3.0, Copyright 2018-2022 Yahoo Inc. */!function(){var e={835:function(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i[r]=o[r])}return i},writable:!0,configurable:!0})},231:function(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e})},570:function(){function e(e,t){return void 0===t&&(t=0),this.indexOf(e,t)>=0}String.prototype.includes||(String.prototype.includes=e),Array.prototype.includes||(Array.prototype.includes=e)}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,i),r.exports}!function(){"use strict";i(570),i(835),i(231);function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return t.get(e)}function s(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,r(e,t,"get"))}function a(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=i}}(e,r(e,t,"set"),i),i}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function h(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var f=n((function t(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(this,t),this.type=i,this.meta=n,this.target=null})),p=f;function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}var m=function(t){u(o,t);var i=v(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(p);o(m,"SCROLL","page.scroll"),o(m,"RESIZE","page.resize"),o(m,"VISIBILITY","page.visibility"),o(m,"FOCUS","window.focus"),o(m,"BLUR","window.blur"),o(m,"FOCUS_IN","window.focus_in"),o(m,"BLUR_CAPTURE","window.blur_capture"),o(m,"DOM_LOADED","dom.loaded"),o(m,"LOADED","page.loaded"),o(m,"BEFORE_UNLOAD","page.stopped"),o(m,"MOUSE_OVER","page.mouse_over"),o(m,"MOUSE_OUT","page.mouse_out");var g={addDOMLoadListener:function(e){if("loading"!==document.readyState)return e();document.addEventListener("DOMContentLoaded",e,!1)},addPageLoadListener:function(e){if("complete"===document.readyState)return e();window.addEventListener("load",e,!1)}};function E(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,n=null,o=null,r=function(){e.apply(i,o),n=null};return function(){if(!n){for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];o=i,n=setTimeout(r,t)}}}function y(e,t){if(Array.isArray(t)){if(t.includes(e))return!0}else for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&t[i]===e)return!0;return!1}var _="function",w="number",O="object",b="string",A="undefined";function T(e){return l(e)!==A}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=Number.NaN;return l(e)===w?o=e:l(e)===b&&(o=Number(e),isNaN(o)&&(o=parseFloat(e))),isNaN(o)||T(i)&&o<i||T(n)&&o>n?t:o}var S={isSet:T,isFunction:function(e){return l(e)===_},isString:function(e){return l(e)===b},isObject:function(e){return l(e)===O},num:R,int:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=R(e,t,i,n);return l(o)!==w||isNaN(o)?t:Math.round(o)},isDOMNode:function(e){return e instanceof HTMLElement},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}};function P(){try{for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];console.log.apply(console,[].slice.call(t))}catch(e){}}var C="exists",D="remove",k={on:function(e,t,i){this.eventTypes||(this.eventTypes={}),this.eventTypes[e]||(this.eventTypes[e]=[]),y(t,this.eventTypes[e])||(i?this.eventTypes[e].push({ref:i,handler:t}):this.eventTypes[e].push(t))},off:function(e,t,i){this.eventTypes&&Array.isArray(this.eventTypes[e])&&this._validateOrRemove.call(this,e,t,i,D)},hasEventListener:function(e,t,i){return!(!this.eventTypes||!Array.isArray(this.eventTypes[e]))&&this._validateOrRemove.call(this,e,t,i,C)},trigger:function(e){if(this.eventTypes&&l(e)===O&&l(e.type)===b&&this.eventTypes[e.type]){e.target=e.target||this;for(var t=this.eventTypes[e.type].slice(0),i=0;i<t.length;i++){var n=t[i];if(l(n)===O)try{n.handler.call(n.ref,e)}catch(t){P("Error calling callback",n,e,t)}else try{n(e)}catch(t){P("Error calling callback",e,t)}}}},_validateOrRemove:function(e,t,i,n){for(var o=0;o<this.eventTypes[e].length;o++){var r=this.eventTypes[e][o],s=i?O:_;if(s===l(r))switch(s){case _:if(r===t)return n===D&&this.eventTypes[e].splice(o,1),!0;break;case O:if(r.handler===t&&r.ref===i)return n===D&&this.eventTypes[e].splice(o,1),!0}}return!1}};function I(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}var N=new WeakMap,L=new WeakMap,M=new WeakMap,x=new WeakMap,F=new WeakMap,j=function(){function t(){var i=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{throttleTime:200};e(this,t),I(this,N,{writable:!0,value:!1}),I(this,L,{writable:!0,value:!1}),I(this,M,{writable:!0,value:!1}),I(this,x,{writable:!0,value:void 0}),I(this,F,{writable:!0,value:void 0}),o(this,"on",(function(e,t,i){Object.getPrototypeOf(this).on.call(this,e,t,i);var n,o=!1;if((e===m.DOM_LOADED&&this.domLoaded||e===m.LOADED&&this.pageLoaded||e===m.VISIBILITY)&&(o=!0),o)if(n=e===m.VISIBILITY?new m(m.VISIBILITY,{hidden:!!window.document.hidden}):e===m.DOM_LOADED?new m(m.DOM_LOADED):new m(m.LOADED,{timestamp:s(this,F)}),i)try{t.call(i,n)}catch(e){P("Error calling callback",t,event)}else t(n)})),g.addDOMLoadListener((function(){a(i,N,!0),i.trigger(new m(m.DOM_LOADED))})),g.addPageLoadListener((function(){a(i,L,!0),a(i,F,(new Date).getTime()),i.trigger(new m(m.LOADED,{timestamp:s(i,F)}))}));var r=n.throttleTime;window.addEventListener("scroll",E((function(){return i.dispatchViewportEvent(m.SCROLL)}),r),!0),window.addEventListener("resize",E((function(){return i.dispatchViewportEvent(m.RESIZE)}),r)),document.addEventListener("visibilitychange",(function(){return i.dispatchVisibilityChange()})),a(this,M,!window.document.hidden),window.addEventListener("focus",(function(e){return i.dispatchFocusChange(!0,e)})),window.addEventListener("blur",(function(e){return i.dispatchFocusChange(!1,e)})),a(this,x,document.hasFocus()),window.addEventListener("beforeunload",(function(){return i.trigger(new m(m.BEFORE_UNLOAD))})),window.document.addEventListener("mouseover",(function(e){return i.trigger(new m(m.MOUSE_OVER,{nativeEvent:e}))})),window.document.addEventListener("mouseout",(function(e){return i.trigger(new m(m.MOUSE_OUT,{nativeEvent:e}))})),window.addEventListener("focusin",(function(e){return i.trigger(new m(m.FOCUS_IN,{nativeEvent:e}))})),window.addEventListener("blur",(function(e){return i.trigger(new m(m.BLUR_CAPTURE,{nativeEvent:e}))}),!0)}return n(t,[{key:"dispatchViewportEvent",value:function(e){this.trigger(new m(e))}},{key:"dispatchVisibilityChange",value:function(){a(this,M,!window.document.hidden),this.trigger(new m(m.VISIBILITY,{hidden:!s(this,M)}))}},{key:"dispatchFocusChange",value:function(e,t){if(s(this,x)!==e){a(this,x,e);var i=e?m.FOCUS:m.BLUR;this.trigger(new m(i,{nativeEvent:t}))}}},{key:"domLoaded",get:function(){return s(this,N)}},{key:"pageLoaded",get:function(){return s(this,L)}},{key:"isVisible",get:function(){return s(this,M)}},{key:"hasFocus",get:function(){return s(this,x)}},{key:"_reset",value:function(){a(this,N,!1),a(this,L,!1)}}]),t}();Object.assign(j.prototype,k);var U=j;function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,o,r=[],s=!0,a=!1;try{for(i=i.call(e);!(s=(n=i.next()).done)&&(r.push(n.value),!t||r.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==i.return||i.return()}finally{if(a)throw o}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var W="jac.sandbox",V=n((function t(i){var n=i.topic,o=i.meta,r=void 0===o?{}:o;e(this,t),this.topic=n,this.meta=r}));function B(e,t,i,n){var o=document.createElement("div");t=(t-=2)<66?66:t,o.style.cssText="top:0;right:0;font-size:12px;user-select:none;border-color:#e2e2e2;font-family:Helevetica Neue,Arial,sans-serif;color:#000;height:24px;display:block;"+"min-width:".concat(66,"px;max-width:").concat(t,"px;white-space:nowrap;z-index:214748366;")+"position:absolute;border-style:solid;width:auto;cursor:pointer;border-width:1px;"+i;var r='<span style="position:absolute;right:0;font-size:20px;width:19px;'+'top:2px;line-height:20px;border-left:1px solid black;margin-left:5px;">'.concat(n,"</span>");return o.innerHTML='<span style="'.concat("position:relative;padding:5px 26px 5px 10px;text-align:center;display:block;width:auto;height:auto;overflow:hidden;text-overflow: ellipsis;",'" title="').concat(e,'">').concat(e).concat(r,"</span>"),o}o(V,"topic",{WRITE_COMPLETE:"".concat(W,".writeComplete"),PAGE_LOAD:"".concat(W,".pageLoad"),SIZE:"".concat(W,".size"),UNLOAD:"".concat(W,".unload"),CLOSE_AD:"".concat(W,".closeAd"),CONFIG:"".concat(W,".config")});var H=function(){function t(){e(this,t)}return n(t,null,[{key:"createCloseAdButton",value:function(e,t){return B(e,t,"border-color:#e2e2e2;border-bottom-left-radius:6px;background-color:#e2e2e2;","&times;")}},{key:"createOpenAdButton",value:function(e,t){var i=B(e,t,"background:#fff;border-color:#000;border-radius:4px;","&plus;");return i.className="jac-show-ad",i}}]),t}(),Z="jac_close";function J(e){var t=e.document,i=e.closeLabel,n=e.maxWidth,o=e.closeHandler,r=H.createCloseAdButton(i,n);r.setAttribute("id",Z),r.addEventListener("click",o,!1),t.body.appendChild(r)}var Y=function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window,o=n.document,r=e.client.closeButton.enabledForSizes,s="".concat(t.width,"x").concat(t.height),a=!0;Array.isArray(r)&&!r.includes(s)&&(a=!1);var c=o.getElementById(Z);c&&c.parentNode.removeChild(c),e.client.closeButton.enabled&&a&&J({document:o,closeLabel:e.client.closeButton.labels.close,maxWidth:t.width,closeHandler:function(){i.send(new V({topic:V.topic.CLOSE_AD,meta:{closeConfig:e.client.closeButton,adSize:{width:t.width}}}))}})};function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}var X=function(t){u(o,t);var i=q(o);function o(t){var n,r=t.cmd,s=void 0===r?null:r,a=t.status,c=void 0===a?null:a,u=t.meta,l=void 0===u?{}:u;return e(this,o),(n=i.call(this,{topic:o.topic.SAFE_FRAME,meta:l})).cmd=s,n.status=c,n}return n(o)}(V);function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}o(X,"topic",{SAFE_FRAME:"jac.sandbox.sf"}),o(X,"cmd",{EXPAND_OVER:"exp-ovr",EXPAND_PUSH:"exp-push",RESIZE_TO:"resize-to",COLLAPSE:"collapse",READ_COOKIE:"read-cookie",WRITE_COOKIE:"write-cookie",MSG:"msg",HIDE:"hide",SHOW:"show"}),o(X,"status",{COLLAPSED:"collapsed",COLLAPSING:"collapsing",EXPANDED:"expanded",EXPANDING:"expanding",RESIZE_TO:"resize-to",GEOMETRY_UPDATE:"geom-update",FOCUS_CHANGE:"focus-change",READ_COOKIE:"read-cookie",WRITE_COOKIE:"write-cookie",FAILED:"failed",CMP:"cmp",MSG:"msg",META_UPDATE:"meta-update",HIDE:"hide",SHOW:"show",REGISTER:"register"});var $=function(t){u(o,t);var i=K(o);function o(t){var n;return e(this,o),(n=i.call(this,t.topic)).message=t,n}return n(o)}(p);function Q(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}var ee=new WeakMap,te=new WeakMap,ie=new WeakMap,ne=function(){function t(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(this,t),Q(this,ee,{writable:!0,value:void 0}),Q(this,te,{writable:!0,value:void 0}),Q(this,ie,{writable:!0,value:void 0}),a(this,ee,n),this.targetWindow=i,a(this,ie,o),Object.keys(o).forEach((function(e){(o[e].before||[]).concat(o[e].after||[]).forEach((function(e){o[e]=o[e]||{}}))}))}return n(t,[{key:"_sendBulkMessages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.filter((function(t){return s(e,ie)[t]})).forEach((function(t){e.send(new V({topic:t})),delete s(e,ie)[t]}))}},{key:"send",value:function(e){var t=s(this,ie)[e.topic];delete s(this,ie)[e.topic],t&&this._sendBulkMessages(t.before),this.targetWindow.postMessage(Object.assign({token:s(this,ee)},e),"*"),t&&this._sendBulkMessages(t.after)}},{key:"listen",value:function(){var e=this;s(this,te)||(a(this,te,(function(t){return e._handlePostMessage(t)})),window.addEventListener("message",s(this,te)))}},{key:"cleanup",value:function(){window.removeEventListener("message",s(this,te)),a(this,te,null)}},{key:"_handlePostMessage",value:function(e){if(this._shouldReadPostMessage(e)){var t=new(e.data.topic===X.topic.SAFE_FRAME?X:V)(e.data),i=new $(t);this.trigger(i)}}},{key:"_shouldReadPostMessage",value:function(e){return e.source===this.targetWindow&&e.data&&e.data.token===s(this,ee)&&e.data.topic}}]),t}();Object.assign(ne.prototype,k);var oe=ne;var re={setStyles:function(e,t){Object.keys(t).forEach((function(i){void 0!==t[i]&&(e.style[i]=t[i])}))},getComputedStyle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,n=i.getComputedStyle(e);return t?n.getPropertyValue(t):n}},se="hidden",ae="scroll",ce="auto";function ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e,i=document.documentElement,n=t.innerWidth||i.clientWidth||0,o=t.innerHeight||i.clientHeight||0,r=t.screenLeft||t.screenX||0,s=r+n,a=t.screenTop||t.screenY||0,c=a+o;return{top:a,left:r,bottom:c,right:s,width:n,height:o}}function le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=e.getBoundingClientRect()||{},n=i.left,o=i.right,r=i.top,s=i.bottom;e===t.document.body&&s<t.innerHeight&&(s=t.innerHeight),e===t.document.body&&o<t.innerWidth&&(o=t.innerWidth);var a=re.getComputedStyle(e,"z-index",t),c=o-n,u=s-r;return{left:n,right:o,top:r,bottom:s,width:c,height:u,zIndex:a}}function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;return de(t)?t.documentElement:t.body}function de(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return"CSS1Compat"===e.compatMode&&e.documentElement}var fe={getWindowGeometry:ue,getElementGeometry:le,getVisibilityMetrics:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=ue(t),n=i.width,o=i.height,r=le(e,t),s=r.width*r.height;r.width=r.width||1,r.height=r.height||1;var a,c,u=r.top>r.bottom;if(r.right<=0||r.left>n)a=0;else{var l=Math.max(-r.left,0),h=Math.max(r.right-n,0);a=r.width-l-h}if(u&&r.bottom<=0||r.top>o)c=0;else{var d=Math.max(-r.top,0),f=Math.max(r.bottom-o,0);c=r.height-d-f}var p=a*c/(s||1);return{containerPixels:s,xPercentage:a/r.width,yPercentage:c/r.height,totalPercentage:Math.min(p,1)}},isClippingElement:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"X",i=arguments.length>2?arguments[2]:void 0,n=(i=i||re.getComputedStyle(e))["overflow"+t],o=i.overflow;return n===se||n===ae||n===ce||o===se||o===ae||o===ce},isScrollableElement:function(e,t){var i=(t=t||re.getComputedStyle(e)).overflowX,n=t.overflowY,o=t.overflow,r=i===ae||o===ae||(i===ce||o===ce)&&e.scrollWidth>e.clientWidth,s=n===ae||o===ae||(n===ce||o===ce)&&e.scrollHeight>e.clientHeight;return r||s},getPageScrollInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=he(e);return{x:Math.max(t.scrollLeft,0),y:Math.max(t.scrollTop,0),w:Math.max(t.scrollWidth,0),h:Math.max(t.scrollHeight,0)}},getDocumentElement:he},pe=function(){function t(){e(this,t)}return n(t,null,[{key:"isMobileMomentAd",value:function(e){return!!e&&!!e.meta&&"MobileMoments"===e.meta.GoldenFormat}},{key:"computeDisplaySize",value:function(e){var t={width:300,height:533},i=fe.getWindowGeometry();return e.config.client.mobileMoments.enabled&&i.width<=550&&i.width<i.height&&(t.width=i.width,t.height=Math.floor(1.7777777777777777*i.width)),t}}]),t}();function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}var me=function(t){u(o,t);var i=ve(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(p);o(me,"INIT_CALLED","".concat("SandboxApi",".INIT_CALLED"));var ge={clone:function(e){var t=this;return e.map((function(e){return Array.isArray(e)?t.clone(e):"object"===l(e)?Ee.copy(e,{}):e}))},diff:function(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))},isSubset:function(e,t){return this.diff(e,t).length<=0},remove:function(e,t){var i=e.indexOf(t);i>=0&&e.splice(i,1)},removeDuplicates:function(e){return e.filter((function(t,i){return e.indexOf(t)===i}))}},Ee={clone:function(e){return this.copy(e,{})},copy:function(e,t,i){var n=this;return Object.keys(e).forEach((function(o){var r=e[o];S.isDOMNode(r)?i&&S.isSet(t[o])||(t[o]=r):S.isObject(r)&&null!==r&&!Array.isArray(r)?(t[o]=t[o]||{},n.copy(e[o],t[o],i)):i&&S.isSet(t[o])||(t[o]=Array.isArray(r)?ge.clone(r):r)})),t},removeEmptyItems:function(e){var t=this;return Object.keys(e).forEach((function(i){var n=e[i];n&&S.isObject(n)?(t.removeEmptyItems(n),0===Object.keys(n).length&&delete e[i]):(n&&Array.isArray(n)&&0===n.length||S.isString(n)&&!n)&&delete e[i]})),e}};function ye(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}var _e=new WeakMap,we=new WeakMap,Oe=new WeakMap,be=new WeakMap,Ae=function(){function t(i,n){e(this,t),ye(this,_e,{writable:!0,value:void 0}),ye(this,we,{writable:!0,value:void 0}),ye(this,Oe,{writable:!0,value:void 0}),ye(this,be,{writable:!0,value:void 0}),a(this,_e,i),a(this,we,n.service.sizes||[]),a(this,be,Ee.clone(n.client.flexible)),a(this,Oe,s(this,be).enabled&&(s(this,be).width.enabled||s(this,be).height.enabled))}return n(t,[{key:"init",value:function(e){var t=e.w,i=e.h,n=e.ratio,o=e.config,r=s(this,we).includes("".concat(t,"x").concat(i)),c=null;r&&!s(this,Oe)?c={width:t,height:i}:n&&(s(this,be).enabled||s(this,be).enabledByAds)&&(r=!0,c={ratio:n},a(this,Oe,!0)),o&&s(this,_e).send(new V({topic:V.topic.CONFIG,meta:o})),c&&s(this,_e).send(new V({topic:V.topic.SIZE,meta:c})),r&&this.trigger(new me(me.INIT_CALLED,c))}},{key:"unload",value:function(){s(this,_e).send(new V({topic:V.topic.UNLOAD}))}}]),t}();Object.assign(Ae.prototype,k);var Te=Ae,Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.features||{};return{"exp-ovr":!(!t.expandOver||!t.expandOver.enabled),"exp-push":!(!t.expandPush||!t.expandPush.enabled),"read-cookie":!(!t.cookies||!t.cookies.read),"write-cookie":!(!t.cookies||!t.cookies.write),"resize-to":!(!t.resize||!t.resize.enabled)}},Se=/^(\d+)x(\d+)$/,Pe=function(e){return e&&e.match(Se)},Ce=function(e){var t={width:0,height:0},i=e.match(Se);return i&&(t.width=parseInt(i[1]),t.height=parseInt(i[2])),t},De={getParameter:function(e,t){t=t.replace(/[[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},getParameters:function(e,t){var i=this;return t.reduce((function(t,n){var o=i.getParameter(e,n);return o&&(t[n]=o),t}),{})},removeParameters:function(e){return e&&"string"==typeof e?e.split(/[?#]/)[0]:""}},ke=30;function Ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=De.getParameter(e.location.href,"jac.debug");"1"===t&&(ke=10)}var Ne={init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;Ie(e)},debug:function(){ke<=10&&console.debug.apply(console,arguments)},info:function(){ke<=20&&console.info.apply(console,arguments)},warning:function(){ke<=30&&console.warn.apply(console,arguments)},error:function(){ke<=40&&console.error.apply(console,arguments)}};Ie();var Le={NOT_SUPPORTED:"Feature not supported by the host.",NOT_REGISTERED:"No prior $sf.ext.register() API call.",EXPANDED:"Already expanded.",NOT_EXPANDED:"Not expanded.",COMMAND_PENDING:"Command already in-progress.",INVALID_COOKIE_ARGS:"Invalid cookie arguments.",INVALID_ARGS:"Invalid arguments.",INVALID_SIZE:"Setting size to less than 1px is hiding, call $sf.ext.hide instead.",SIZE_CONSTRAINTS_ERROR:"Setting size to a value bigger than the allowed constraints.",INVALID_HIDDEN_SIZE:"Setting size must be greater than 15 if SafeFrame has been hidden.",MISSING_RESIZE_FLEXIBLE_RATIO:"Flexible safeframes can only be resized by ratio.",NOT_ALLOWED_FLEXIBLE_EXPAND:"Flexible safeframe expansion is not supported."},Me={COLLAPSED:"collapsed",COLLAPSING:"collapsing",EXPANDED:"expanded",EXPANDING:"expanding",RESIZING:"resizing",HIDDEN:"hidden"},xe=function(){function t(i,n){var r=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;e(this,t),o(this,"messenger",void 0),o(this,"windowContext",void 0),o(this,"sizesConfig",void 0),o(this,"hasRegistered",!1),o(this,"pendingCommand",null),o(this,"alignmentElement",void 0),o(this,"statusUpdateCallback",void 0),o(this,"supportsMap",void 0),o(this,"geomData",void 0),o(this,"hasFocus",void 0),o(this,"metaData",void 0),o(this,"registrationKey",void 0),o(this,"width",void 0),o(this,"height",void 0),o(this,"flexibleConfig",{}),o(this,"isFlexible",void 0),o(this,"_status",Me.COLLAPSED),o(this,"initSandboxCalled",!1),o(this,"sizeConstraints",void 0),this.messenger=i,this.windowContext=a,this.sizesConfig=n.service.sizes||[];var c=n.client.safeFrame;this.supportsMap=Re(c),i.on(X.topic.SAFE_FRAME,this._onSafeFrameMessage,this),(s=s||{}).geom&&(this.geomData=s.geom),s.focus&&(this.hasFocus=s.focus),this.metaData=s.meta||{},this.flexibleConfig=n.client.flexible,this.isFlexible=this.flexibleConfig.enabled,this.sizeConstraints={width:c.width,height:c.height},a.JAC.sandbox.on(me.INIT_CALLED,(function(e){r.initSandboxCalled=!0,e.meta&&e.meta.ratio&&(r.isFlexible=!0)}))}return n(t,[{key:"_sendMessage",value:function(e){var t=e.cmd,i=e.meta;this.messenger.send(new X({cmd:t,meta:i})),this.pendingCommand=t}},{key:"_onSafeFrameMessage",value:function(e){var t=e.message,i=t.status,n=t.meta;if(y(i,X.status)){if(this.pendingCommand===n.cmd&&(this.pendingCommand=null,i===X.status.FAILED))switch(n.cmd){case X.cmd.EXPAND_OVER:case X.cmd.EXPAND_PUSH:case X.cmd.RESIZE_TO:this._status=Me.COLLAPSED;break;case X.cmd.COLLAPSE:this._status=Me.EXPANDED}this._callStatusUpdate(i,n)}}},{key:"register",value:function(e,t,i){if(this.hasRegistered)Ne.error("$sf.ext.register() can be called only once and has been called already.");else{if(this.hasRegistered=!0,S.isFunction(i)&&(this.statusUpdateCallback=i),this.initSandboxCalled)Ne.warning("".concat(e,"x").concat(t," size is ignored as size was set already."));else if(this.sizesConfig.includes("".concat(e,"x").concat(t))&&!this.isFlexible){var n=S.int(e,0,0),o=S.int(t,0,0);this.messenger.send(new V({topic:V.topic.SIZE,meta:{width:n,height:o}})),this.width=n,this.height=o}this.registrationKey={},this._callStatusUpdate(X.status.REGISTER,{key:this.registrationKey})}}},{key:"_width",value:function(){return S.isSet(this.width)||(this.width=fe.getWindowGeometry().width),this.width}},{key:"_height",value:function(){return S.isSet(this.height)||(this.height=fe.getWindowGeometry().height),this.height}},{key:"_isValidSize",value:function(e,t){var i=!this.sizeConstraints.width||!this.sizeConstraints.width.max||e<=this.sizeConstraints.width.max,n=!this.sizeConstraints.height||!this.sizeConstraints.height.max||t<=this.sizeConstraints.height.max;return i&&n}},{key:"_callStatusUpdate",value:function(e,t){var i=t.cmd,n=t.reason,o=t.info,r=t.key;if(e===X.status.FAILED?Ne.warning("SafeFrame: command failed",{cmd:i,reason:n,info:o}):e===X.status.META_UPDATE?this.metaData=o:e===X.status.GEOMETRY_UPDATE?this.geomData=o:e===X.status.FOCUS_CHANGE?this.hasFocus=o:e===X.status.RESIZE_TO?(this.width=o.w,this.height=o.h,this._status=Me.COLLAPSED):y(e,Me)&&(e===X.status.COLLAPSED&&this._align(),this._status=e),this.statusUpdateCallback){var s={cmd:i,reason:n,info:o};r&&(s.key=r),this.statusUpdateCallback.call(this,e,s)}}},{key:"_sendFailureStatus",value:function(e,t){this._callStatusUpdate(X.status.FAILED,{cmd:e,reason:t})}},{key:"supports",value:function(e){return S.isSet(e)?!!this.supportsMap[e]:this.supportsMap}},{key:"expand",value:function(e){var t,i=e.t,n=e.l,o=e.r,r=e.b,s=e.push?X.cmd.EXPAND_PUSH:X.cmd.EXPAND_OVER;this.supports(s)?this.hasRegistered?this.pendingCommand?t=Le.COMMAND_PENDING:this.status()===Me.EXPANDED?t=Le.EXPANDED:this.isFlexible&&(t=Le.NOT_ALLOWED_FLEXIBLE_EXPAND):t=Le.NOT_REGISTERED:t=Le.NOT_SUPPORTED;var a={top:S.int(i,0,0),left:S.int(n,0,0),right:S.int(o,0,0),bottom:S.int(r,0,0)},c=this._width()+a.left+a.right,u=this._height()+a.top+a.bottom;this._isValidSize(c,u)||(t=Le.SIZE_CONSTRAINTS_ERROR),t?this._sendFailureStatus(s,t):(this._align(a),this._sendMessage({cmd:s,meta:a}),this._status=Me.EXPANDING)}},{key:"collapse",value:function(){var e,t=X.cmd.COLLAPSE;this.hasRegistered?this.pendingCommand?e=Le.COMMAND_PENDING:this.status()!==Me.EXPANDED&&(e=Le.NOT_EXPANDED):e=Le.NOT_REGISTERED,e?this._sendFailureStatus(t,e):(this._sendMessage({cmd:t}),this._status=Me.COLLAPSING)}},{key:"_align",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.top,i=e.left,n=e.right,o=e.bottom;this.alignmentElement||(this.alignmentElement=this.windowContext.document.getElementById("fc_align"));var r={};t&&!o?(r.top=null,r.bottom="0"):(r.top="0",r.bottom=null),i&&!n?(r.left=null,r.right="0"):(r.left="0",r.right=null),re.setStyles(this.alignmentElement,r),this._adjustWindowContentSize()}},{key:"_adjustWindowContentSize",value:function(){var e=this.windowContext.document.documentElement.style;e.width=e.height="100%"}},{key:"cookie",value:function(e,t){var i,n=t?X.cmd.WRITE_COOKIE:X.cmd.READ_COOKIE;this.supports(n)?this.hasRegistered?!e||t&&!t.value?i=Le.INVALID_COOKIE_ARGS:this.pendingCommand&&(i=Le.COMMAND_PENDING):i=Le.NOT_REGISTERED:i=Le.NOT_SUPPORTED,i?this._sendFailureStatus(n,i):this._sendMessage({cmd:n,meta:{cookieName:e,cookieData:t}})}},{key:"meta",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"shared",i=Object.prototype.hasOwnProperty,n=this.metaData;if(i.call(n,t)){var o=n[t];if(i.call(o,e))return o[e]}return""}},{key:"status",value:function(){return this._status}},{key:"geom",value:function(){return this.geomData}},{key:"inViewPercentage",value:function(){if(this.geomData){var e=this.geomData.self.iv;return Math.round(100*e)}}},{key:"winHasFocus",value:function(){return this.hasFocus}},{key:"resizeTo",value:function(e){var t,i,n,o=X.cmd.RESIZE_TO;if(this.supports(X.cmd.RESIZE_TO)?S.isObject(e)?this.hasRegistered?this._status===Me.EXPANDED?n=Le.EXPANDED:this.pendingCommand?n=Le.COMMAND_PENDING:this.isFlexible&&!Pe(e.ratio)&&(n=Le.MISSING_RESIZE_FLEXIBLE_RATIO):n=Le.NOT_REGISTERED:n=Le.INVALID_ARGS:n=Le.NOT_SUPPORTED,!n)if(t=S.int(e.w,this._width()),i=S.int(e.h,this._height()),t<=1||i<=1)n=Le.INVALID_SIZE;else if(this._status===Me.HIDDEN&&(t<=15||i<=15))n=Le.INVALID_HIDDEN_SIZE;else{if(t===this.width&&i===this.height&&!this.isFlexible)return;this.isFlexible||this._isValidSize(t,i)||(n=Le.SIZE_CONSTRAINTS_ERROR)}n?this._sendFailureStatus(o,n):(this._adjustWindowContentSize(),this._sendMessage({cmd:X.cmd.RESIZE_TO,meta:this.isFlexible?{ratio:e.ratio}:{width:t,height:i}}),this._status=Me.RESIZING)}},{key:"hide",value:function(e){this._status=Me.HIDDEN}},{key:"show",value:function(e){}},{key:"ui",value:function(){var e={flex:0};return this.flexibleConfig.enabledByAds&&!this.isFlexible&&(e.flexCanBeActivated=!0),this.isFlexible&&(this.flexibleConfig.width.enabled&&this.flexibleConfig.height.enabled?e.flex="both":this.flexibleConfig.width.enabled?e.flex="w":this.flexibleConfig.height.enabled&&(e.flex="h")),e}}]),t}();function Fe(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}o(xe,"FailureReason",Le);var je=new WeakMap,Ue=function(){function t(i,n,o,r){e(this,t),Fe(this,je,{writable:!0,value:void 0}),a(this,je,new xe(i,n,o,r))}return n(t,[{key:"register",value:function(e,t,i){s(this,je).register(e,t,i)}},{key:"supports",value:function(e){return s(this,je).supports(e)}},{key:"expand",value:function(e){s(this,je).expand(e)}},{key:"collapse",value:function(){s(this,je).collapse()}},{key:"cookie",value:function(e,t){s(this,je).cookie(e,t)}},{key:"meta",value:function(e,t){return s(this,je).meta(e,t)}},{key:"status",value:function(){return s(this,je).status()}},{key:"geom",value:function(){return s(this,je).geom()}},{key:"inViewPercentage",value:function(){return s(this,je).inViewPercentage()}},{key:"winHasFocus",value:function(){return s(this,je).winHasFocus()}},{key:"resizeTo",value:function(e){return s(this,je).resizeTo(e)}},{key:"hide",value:function(e){return s(this,je).hide(e)}},{key:"show",value:function(e){return s(this,je).show(e)}},{key:"msg",value:function(e,t){s(this,je).msg(e,t)}},{key:"ui",value:function(){return s(this,je).ui()}},{key:"hostURL",value:function(){return document.referrer}}]),t}(),Ge=function(){function t(i){e(this,t),o(this,"messenger",void 0),o(this,"lastMessageSentTime",void 0),this.messenger=i}return n(t,[{key:"_sendMessage",value:function(e){var t=e.cmd,i=e.meta;this.messenger.send(new X({cmd:t,meta:i}))}},{key:"msg",value:function(e){return!(this.lastMessageSentTime&&!(this.lastMessageSentTime<(new Date).getTime()-200))&&(this._sendMessage({cmd:X.cmd.MSG,meta:e}),this.lastMessageSentTime=(new Date).getTime(),!0)}}]),t}(),ze={"1AS":"1AS",RAS:"RAS",SSP:"SSP",VZMSSP:"VZMSSP",PG:"PG",pointguard:"pointguard"},We="px",Ve=1,Be=2,He=3,Ze="SF",Je="NFIF",Ye="FIF",qe=0,Xe=1,Ke=2,$e=3,Qe=4,et=5,tt={LB:["728x90","970x250"],RR:["300x250","300x600"],MM:["300x250","320x50"],LREC:["300x250"],MON:["300x600"],LDRB:["728x90"],MAST:["970x250"]};function it(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}var nt="Position",ot=function(t){u(o,t);var i=it(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(p);function rt(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}o(ot,"CONFIG_UPDATE","".concat(nt,".CONFIG_UPDATE")),o(ot,"ROTATION_UPDATE","".concat(nt,".ROTATION_UPDATE"));var st,at=new WeakMap,ct=new WeakMap,ut=function(){function t(i,n){if(e(this,t),rt(this,at,{writable:!0,value:void 0}),rt(this,ct,{writable:!0,value:!1}),o(this,"name",void 0),o(this,"config",void 0),o(this,"adData",void 0),o(this,"fetch",void 0),o(this,"render",void 0),!S.isString(i))throw new Error("Invalid ".concat("name"," argument. String is expected"));this.name=i,this.update(n)}return n(t,[{key:"update",value:function(e){this.config=e,this.updateContainerType(),this.trigger(new ot(ot.CONFIG_UPDATE,this.config)),this.trigger(new ot(ot.ROTATION_UPDATE,this.config))}},{key:"containerType",get:function(){return s(this,at)}},{key:"updateContainerType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.config.client,i=t.safeFrame,n=t.nonFriendlyIframe;n&&n.enabled?a(this,at,Je):i&&i.enabled?a(this,at,"true"===e.friendlyIframe?Ye:Ze):a(this,at,Ye)}},{key:"resetRotation",value:function(){this.rotated=!1;var e=this.config.resetRotationConfig(),t=this.config.service;t.alias=t.params.origmn||t.alias,delete t.params.origmn,this.trigger(new ot(ot.CONFIG_UPDATE,this.config)),e&&this.trigger(new ot(ot.ROTATION_UPDATE,this.config))}},{key:"updateRotationConfig",value:function(e){this.config.updateRotationConfig(e)&&(this.trigger(new ot(ot.CONFIG_UPDATE,this.config)),this.trigger(new ot(ot.ROTATION_UPDATE,this.config)))}},{key:"alias",get:function(){return this.config.service.alias},set:function(e){if(e){var t=this.config.service;if(t.alias!==e){var i=t.params.origmn||t.alias;i&&(t.params.origmn=i),t.alias=e,this.trigger(new ot(ot.CONFIG_UPDATE,this.config))}}}},{key:"rotated",get:function(){return s(this,ct)},set:function(e){a(this,ct,e)}},{key:"applyAdData",value:function(e){this.adData=e}}]),t}();Object.assign(ut.prototype,k);var lt=!1;function ht(e,t,i){var n=function(e,t){var i=e.document.referrer;if(!i&&mt(e)&&(i=e.parent.location.href),!t||!i)return!1;var n=i.match(/^(https?:\/\/)?([^/?]*).*$/);if(!n||n.length<3)return!1;var o=n[2],r=["aol.com","yahoo.com","msn.com"].filter((function(e){return o.endsWith(e)}));return t&&0===r.length&&Ne.error("JAC nested iframes for domain ".concat(o," are not supported.")),r.length>0}(t,i)?t.parent:t.top,r=o({},V.topic.UNLOAD,{before:[V.topic.WRITE_COMPLETE],after:[]});st=new oe(n,e,r)}function dt(e){var t=e.positionConfig,i=e.initialWidth,n=e.initialHeight,o=e.allowedSizes,r=t.client.sandbox.anchorTarget;if(st.send(new V({topic:V.topic.PAGE_LOAD})),lt&&!t.client.flexible.enabled&&pt(i,n,o,t),Y(t,{width:i,height:n},st,window),r)for(var s=document.getElementsByTagName("a"),a=0;a<s.length;a++){s[a].setAttribute("target",r)}}var ft=4e3;function pt(e,t,i,n){if(lt){var o=function(e){var t;return e.client.safeFrame.enabled&&(t=document.getElementById("fc_align")),{scrollWidth:(t=t||document.body).scrollWidth,scrollHeight:t.scrollHeight}}(n),r=o.scrollWidth,s=o.scrollHeight;if(r>e||s>t){var a=function(e,t,i){var n=e*t,o=1e5,r={};return i.forEach((function(e){var t=Math.abs(n-e.width*e.height);t<o&&(o=t,r=e)})),r}(r,s,i),c=a.width,u=a.height;st.send(new V({topic:V.topic.SIZE,meta:{width:c,height:u}})),Y(n,{width:c,height:u},st,window)}else ft>0&&(ft-=100,setTimeout((function(){pt(e,t,i,n)}),100))}}function vt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,n=e.config;if(e.containerType===Ze){var o=i.document.getElementById("fc_align"),r=n.client.flexible.enabled||t;r&&o&&(o.style.width="100%")}}function mt(e){var t=!1;try{e.parent.location.href&&(t=!0)}catch(e){t=!1}return t}var gt={service:{params:{}},client:{fetch:{auto:!0,minInterval:2e3,timeout:3e4,cacheTTL:6e4},render:{auto:!0,timeout:6e4,requireViewable:!1,doubleBuffering:!1,delayedLoadInLegacyIE:!1,abortOnFocus:!0,abortOnMouseOver:!1,abortOnExpandedAd:!0},layout:{zIndex:10},rotation:{enabled:!1,period:2e4,limit:3,requireViewable:!0,inViewDuration:1e3,resizable:!1,cancellable:!0,onNoAd:!1},nonFriendlyIframe:{enabled:!1},safeFrame:{enabled:!0,features:{expandOver:{enabled:!0},expandPush:{enabled:!1},resize:{enabled:!1},cookies:{read:!1,write:!1,allowed:["CRZY"]}}},sandbox:{baseUrl:null,uniqueDomain:!1,anchorTarget:"_blank",features:{fullscreen:{enabled:!0},autoplay:{enabled:!0},geolocation:{enabled:!1},camera:{enabled:!1},microphone:{enabled:!1}},allow:["forms","scripts","same-origin","popups","popups-to-escape-sandbox"]},nestedIframe:!1,placeholder:{enabled:!1,text:"Advertisement",fontSize:"12px",textColor:"#6e7780",backgroundColor:"#f5f8fa"},closeButton:{enabled:!1,showButtonEnabled:!0,preserveState:!1,animation:{enabled:!0,duration:333},labels:{close:"Close ad",show:"Show ad"}},flexible:{enabled:!1,enabledByAds:!1,width:{enabled:!0,min:0,max:9999},height:{enabled:!0,min:0,max:9999},ratio:""},mobileMoments:{enabled:!1},viewability:{percent:50,pixels:0,duration:1e3,clearOnPageInactive:!1},content:{},meta:{shared:{}}}},Et={client:{closeButton:{animation:{duration:{minimum:0,rule:!0}}},fetch:{minInterval:{minimum:500,rule:!0}},flexible:{width:{min:{minimum:0,maximum:9999,rule:!0},max:{minimum:0,maximum:9999,rule:!0}},height:{min:{minimum:0,maximum:9999,rule:!0},max:{minimum:0,maximum:9999,rule:!0}}},rotation:{period:{minimum:100,rule:!0},limit:{minimum:1,rule:!0}}}};function yt(e,t){Object.keys(t).forEach((function(i){var n,o,r=l(e[i]);t[i].rule?"undefined"!==r&&(n=e[i],o=t[i],"number"==typeof n&&"number"==typeof o.minimum&&n<o.minimum||"number"==typeof n&&"number"==typeof o.maximum&&n>o.maximum)&&delete e[i]:"object"===r&&yt(e[i],t[i])}))}function _t(e){var t=Ee.clone(gt);return Ee.copy(e,t),t}var wt=function(){function t(i){e(this,t),o(this,"service",void 0),o(this,"client",void 0),o(this,"input",void 0),this.update(i)}return n(t,[{key:"update",value:function(e){if(!S.isObject(e.client))throw new Error("Invalid ".concat("client"," argument. Object is expected"));if(!S.isSet(e.client.targetElement))throw new Error("No target HTML element configured for position.");var t,i=((t=Ee.clone(e)).client&&t.client.features&&(Ne.warning('JAC: Support for the "features" property of the client config has been deprecated and will be removed in the future versions. Please move all the "features" one level up in the config.'),Object.assign(t.client,t.client.features),delete t.client.features),t);this.input=Ee.clone(i),yt(i,Et);var n=_t(i);Object.assign(this,n)}},{key:"updateRotationConfig",value:function(e){var t=this,i=!1;return e?(Object.keys(e).forEach((function(n){var o=e[n];o!==t.client.rotation[n]&&(t.client.rotation[n]=o,i=!0)})),i):i}},{key:"resetRotationConfig",value:function(){var e=_t(Ee.clone(this.input)).client.rotation;return this.updateRotationConfig(e)}},{key:"updateMeta",value:function(e,t,i){var n=!1,o=S.isString(e)&&S.isSet(t);return S.isObject(e)?(this.client.meta=e,n=!0):S.isString(i)&&this.client.meta[i]&&o?(this.client.meta[i][e]=t,n=!0):o&&(this.client.meta.shared[e]=t,n=!0),n}},{key:"getTargetElement",value:function(){var e=this.client.targetElement;return S.isString(e)?document.getElementById(e):e}}],[{key:"getFromConfig",value:function(e,t){var i=e.service&&e.service.positions||{},n=e.client&&e.client.positions||{},o=i[t],r=n[t];return o||r?{service:o||{},client:r||{}}:null}},{key:"updateInConfig",value:function(e,t,i){var n=i.service,o=i.client;n&&(e.service=e.service||{},e.service.positions=e.service.positions||{},e.service.positions[t]=n),o&&(e.client=e.client||{},e.client.positions=e.client.positions||{},e.client.positions[t]=o)}},{key:"removeFromConfig",value:function(e,t){e.service.positions&&delete e.service.positions[t],e.client.positions&&delete e.client.positions[t]}}]),t}();o(wt,"MINIMUM_ROTATION_INTERVAL",100),o(wt,"DEFAULT_RENDER_TIMEOUT",6e4);var Ot="RefreshSmall",bt="RefreshLarge",At=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e(this,t),t.PAGE_ROTATION_INFO=t._getPageRotationParams(i)}return n(t,[{key:"createRotationConfig",value:function(e,t){var i=Ee.clone(e.client.rotation);if(i.enabled){this._shouldRotateFromComments(t)||(i.enabled=!1);var n=this._getEnvironmentRotationInfo(e,t);return n.RefreshTime&&(i.period=1e3*n.RefreshTime),n.RefreshMax&&(i.limit=n.RefreshMax),n.RefreshKeepSize&&(i.resizable="N"===n.RefreshKeepSize),i}}},{key:"getRotationAliasBasedOnSize",value:function(e,t){return t=t||e.content.size,this._isCommentPresent(e,Ot)&&!this._isLargeAd(t)?e.meta.RefreshSmall:this._isCommentPresent(e,bt)&&this._isLargeAd(t)?e.meta.RefreshLarge:void 0}},{key:"_shouldRotateFromComments",value:function(e){var t=e.meta,i=t.AdTypePriority?parseInt(t.AdTypePriority):-1;return!("N"===t.RefreshExclusive&&"N"===t.MP&&i>=493||"N"===t.RefreshReserved&&"N"===t.MP&&i>=200&&i<493)&&(this._isCommentPresent(e,"RefreshMN")||this._isCommentPresent(e,Ot)&&!this._isLargeAd(e.content.size)||this._isCommentPresent(e,bt)&&this._isLargeAd(e.content.size))}},{key:"_getEnvironmentRotationInfo",value:function(e,i){var n={RefreshTime:i.meta.RefreshTime,RefreshMax:i.meta.RefreshMax,RefreshKeepSize:i.meta.RefreshKeepSize};n.RefreshTime=n.RefreshTime?parseInt(n.RefreshTime):void 0,n.RefreshMax=n.RefreshMax?parseInt(n.RefreshMax):void 0;var o={},r=e.input.client&&e.input.client.rotation;return r&&(r.period&&r.period>wt.MINIMUM_ROTATION_INTERVAL&&(o.RefreshTime=r.period/1e3),r.limit&&(o.RefreshMax=r.limit),S.isSet(r.resizable)&&(o.RefreshKeepSize=r.resizable?"N":"Y")),Object.assign(n,o,t.PAGE_ROTATION_INFO)}},{key:"_isCommentPresent",value:function(e,t){return Object.prototype.hasOwnProperty.call(e.meta,t)}},{key:"_isLargeAd",value:function(e){return e.width>=970||e.height>=600}}],[{key:"_getPageRotationParams",value:function(e){var t=De.getParameters(e.location.href,["RefreshTime","RefreshMax","RefreshKeepSize"]);return["RefreshTime","RefreshMax"].forEach((function(e){t[e]&&(t[e]=parseInt(t[e]))})),t}}]),t}();function Tt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}o(At,"PAGE_ROTATION_INFO",void 0);var Rt=function(t){u(o,t);var i=Tt(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(p);o(Rt,"FETCH_START","FETCH_START"),o(Rt,"FETCH_COMPLETE","FETCH_COMPLETE"),o(Rt,"FETCH_TIMEOUT","FETCH_TIMEOUT"),o(Rt,"FETCH_ERROR","FETCH_ERROR"),o(Rt,"RENDER_START","RENDER_START"),o(Rt,"RENDER_COMPLETE","RENDER_COMPLETE"),o(Rt,"POSITION_CREATED","POSITION_CREATED"),o(Rt,"POSITION_ROTATE","POSITION_ROTATE"),o(Rt,"POSITION_RENDER_START","POSITION_RENDER_START"),o(Rt,"POSITION_RENDER_COMPLETE","POSITION_RENDER_COMPLETE"),o(Rt,"POSITION_RENDER_FAILED","POSITION_RENDER_FAILED"),o(Rt,"POSITION_COLLAPSED","POSITION_COLLAPSED"),o(Rt,"POSITION_VIEW_START","POSITION_VIEW_START"),o(Rt,"POSITION_VIEW_END","POSITION_VIEW_END"),o(Rt,"POSITION_VIEWABLE","POSITION_VIEWABLE"),o(Rt,"POSITION_CONFIG_CHANGED","POSITION_CONFIG_CHANGED"),o(Rt,"AD_LOAD_COMPLETE","AD_LOAD_COMPLETE"),o(Rt,"AD_LOAD_TIMEOUT","AD_LOAD_TIMEOUT"),o(Rt,"AD_SIZE_CHANGED","AD_SIZE_CHANGED"),o(Rt,"AD_MESSAGE","AD_MESSAGE"),o(Rt,"AD_CLOSED","AD_CLOSED"),o(Rt,"AD_OPENED","AD_OPENED"),o(Rt,"NO_AD","NO_AD");var St=Rt;function Pt(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}var Ct="DEFAULT",Dt={service:{host:"https://jill.fc.yahoo.com/",debug:!1,adServer:{RAS:{params:{}},SSP:{params:{}},PG:{siteAttributes:{}}},positions:{},site:{name:"",queryParams:"",pageSessionId:"xxxxxxxxx".replace(/[x]/g,(function(){return Math.floor(16*Math.random()).toString(16)}))},user:{regs:{gdpr:{apiStatus:Ke,applies:null,euconsent:""},ccpa:{apiStatus:Ke,usPrivacy:""}},cookies:{},eids:[]}},client:{focusProtection:!0,positions:{},rotation:{groups:[]},idProviders:{yahoo:{pixelId:"58322",email:null}},trackers:{opus:!0,smartPixel:!1,msftSync:!1},metrics:{samplingPercent:5,samplingRateExempt:["FetchTimeoutCount"]}}};function kt(e){var t=Dt.service,i=e.document.referrer;i&&(t.site.referrer=i)}function It(e){var t,i,n;e&&(e.host&&(Dt.service.host=e.host),null!==(t=e.metrics)&&void 0!==t&&t.samplingPercent&&(Dt.client.metrics.samplingPercent=e.metrics.samplingPercent),null!==(i=e.metrics)&&void 0!==i&&i.samplingRateExempt&&(Dt.client.metrics.samplingRateExempt=e.metrics.samplingRateExempt),null!==(n=e.site)&&void 0!==n&&n.category&&(Dt.service.site.category=e.site.category))}function Nt(e){var t,i,n=Ee.clone(Dt);return Ee.copy(e,n),t=n,(i=e).service&&i.service.adServer&&Object.keys(ze).forEach((function(e){i.service.adServer[e]||delete t.service.adServer[e]})),function(e,t){t.client&&t.client.idProviders&&t.client.idProviders.yahoo||delete e.client.idProviders.yahoo}(n,e),n}function Lt(e,t,i){S.isObject(i)?t[e]={}:Array.isArray(i)&&(t[e]=[])}function Mt(e){var t=e&&e.service&&e.service.adServer;return t&&S.isObject(t["1AS"])&&(t.RAS=t["1AS"],delete t["1AS"]),t&&S.isObject(t.VZMSSP)&&(t.SSP=t.VZMSSP,delete t.VZMSSP),e}var xt=new WeakMap,Ft=new WeakMap,jt=function(){function t(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;e(this,t),Pt(this,xt,{writable:!0,value:void 0}),Pt(this,Ft,{writable:!0,value:{}}),o(this,"service",void 0),o(this,"client",void 0),o(this,"input",void 0),o(this,"positions",{}),a(this,xt,r),this.input=Mt(Ee.clone(i)),kt(r),It(n),this._initializeConfig()}return n(t,[{key:"_initializeConfig",value:function(){var e=this,i=Ee.clone(this.input);i.client=i.client||{},i.service=i.service||{};var n=i.service.adServer;n&&n.pointguard&&(n.PG=n.pointguard,delete n.pointguard);var o=Nt(i);this.service=o.service,this.client=o.client;var r=wt.getFromConfig(this.input,Ct);r&&(delete this.service.positions.DEFAULT,delete this.client.positions.DEFAULT,this._addOrUpdatePosition(Ct,r)),Object.keys(this.client.positions).forEach((function(t){var i=wt.getFromConfig(e.input,t);e._addOrUpdatePosition(t,i)})),t.applyOverrides(this,s(this,xt).location.href)}},{key:"addPosition",value:function(e,i){this._addOrUpdatePosition(e,i),t.applyOverrides(this,s(this,xt).location.href)}},{key:"updatePosition",value:function(e,i){this._addOrUpdatePosition(e,i),t.applyOverrides(this,s(this,xt).location.href)}},{key:"_addOrUpdatePosition",value:function(e,t){var i=Ee.clone(t);/^[a-zA-Z0-9_-]+$/.test(e)||Ne.warning("Position name ".concat(e," contains invalid characters. ")+"Please use only alphanumeric characters."),e===Ct?a(this,Ft,i):(Ee.copy(s(this,Ft),i,!0),this.positions[e]?this.positions[e].update(i):this.positions[e]=new wt(i),wt.updateInConfig(this,e,this.positions[e])),wt.updateInConfig(this.input,e,i)}},{key:"removePosition",value:function(e){wt.removeFromConfig(this.input,e),wt.removeFromConfig(this,e),e===Ct?a(this,Ft,{}):delete this.positions[e]}},{key:"setRegulatoryData",value:function(e){this.service.user.regs.gdpr.apiStatus=e.data.GDPR.apiStatus,this.service.user.regs.gdpr.applies=e.data.GDPR.applies,this.service.user.regs.gdpr.euconsent=e.data.GDPR.euconsent,this.service.user.regs.ccpa.apiStatus=e.data.CCPA.apiStatus,this.service.user.regs.ccpa.usPrivacy=e.data.CCPA.usPrivacy}},{key:"setUserIdentity",value:function(e){S.isSet(e.ids.CONNECTID)&&this.service.user.eids.push({source:"yahoo.com",uids:[{id:e.ids.CONNECTID}]})}},{key:"updateMeta",value:function(e,t,i,n){var o=this.positions[e];return!!o&&o.updateMeta(t,i,n)}},{key:"updateConfigSection",value:function(e,i){var n=e.split(".");if(n[0]!==t.SERVICE_PROPERTY&&n[0]!==t.CLIENT_PROPERTY)return Ne.error("Invalid path provided, it has to start with service or client."),!1;var o=n[0],r=function(e,t,i,n){for(var o,r=e,s=t,a=1;a<i.length;a++){if(o=i[a],!S.isSet(r[o]))return Ne.error("Invalid path, property ".concat(o," does not exist.")),!1;s[o]||Lt(o,s,r[o]),a<i.length-1&&(r=r[o],s=s[o])}return r[o]=n,s[o]=n,!0}(this[o],this.input[o],n,i);return r&&this._initializeConfig(),r}},{key:"getPositionNameFromConfigPath",value:function(e){return e.split(".")[2]}},{key:"clone",value:function(){return Ee.clone({service:this.service,client:this.client})}},{key:"getFetchTimeout",value:function(e){var t=this;return(e=e||Object.keys(this.positions)).reduce((function(e,i){var n=t.positions[i].client.fetch.timeout;return!e||n<e?n:e}),null)}},{key:"getServiceConfigForFetch",value:function(e){var t=this,i=Ee.clone(this.service);if(delete i.user.email,delete i.host,i.debug?i.debug=!0:delete i.debug,!i.site.url){var n=s(this,xt).location.href;i.site.url=De.removeParameters(n)}!function(e){e.user.regs.ccpa.usPrivacy||delete e.user.regs.ccpa}(i),Ee.removeEmptyItems(i),this.service.adServer.PG&&!i.adServer&&(i.adServer={PG:{}});var o={};return e.positionNames.forEach((function(n){var r=i.positions,s=r&&r[n]||(t.service.positions[n]?{}:null);if(s){var a=e.optionsPerPosition[n],c=a?a.fetchSize:null;if(t.positions[n].client.rotation.resizable||!c)o[n]=s;else{var u="".concat(c.width,"x").concat(c.height);(a.allowedSizes||s.sizes).includes(u)&&(s.sizes=[u],o[n]=s)}}})),i.positions=o,i}},{key:"isServiceConfigValid",value:function(){if(!this.service)return Ne.warning("No service config has been set."),!1;if(!this.service.adServer)return Ne.warning("No service.adServer config has been set."),!1;if(!this.service.positions)return Ne.warning("No service.positions config has been set."),!1;var e=this.service.adServer,t=Object.keys(ze).filter((function(t){return e[t]}));if(0===t.length)return Ne.warning("No valid adServer config has been set."),!1;if(t.length>1)return Ne.warning("Only one adServer can be configured."),!1;if(t.includes(ze["1AS"])){if(!e["1AS"].region)return Ne.warning("1AS adServer config requires region to be set."),!1}else if(t.includes(ze.RAS)){if(!e.RAS.region)return Ne.warning("RAS adServer config requires region to be set."),!1}else if(t.includes(ze.PG)&&(!this.service.site||!this.service.site.spaceId))return Ne.warning("PG adServer config requires the site spaceId to be set."),!1;return!this.service.host||/^https?:\/\/.*\//i.test(this.service.host)}}],[{key:"applyOverrides",value:function(e,t){var i=De.getParameters(t,["jac.cp","jac.noad","jac.kvs","jac.ip","atwCrPr","atwMN","atwKV"]),n=Object.keys(i).map((function(e){return"".concat(e,"=").concat(i[e])})),o=e.service.site.queryParams,r=o?[o]:[];e.service.site.queryParams=r.concat(n).join("&"),"1"===De.getParameter(t,"jac.debug")&&(e.service.debug=!0);var s=De.getParameter(t,"jac.sf");Object.keys(e.positions).forEach((function(t){var i=e.positions[t];"1"===s&&(i.client.safeFrame.enabled=!0)}));var a=De.getParameter(t,"jac.rotate");a&&Object.keys(e.positions).forEach((function(t){var i=e.positions[t].client;i.rotation&&("0"===a?i.rotation.enabled=!1:i.rotation.period=1e3*a)}))}}]),t}();function Ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}o(jt,"CLIENT_POSITIONS_PROPERTY","client.positions"),o(jt,"SERVICE_PROPERTY","service"),o(jt,"CLIENT_PROPERTY","client");var Gt="Jill",zt=function(t){u(o,t);var i=Ut(o);function o(t,n){var r;return e(this,o),(r=i.call(this,t)).meta=n,r}return n(o)}(p);o(zt,"FETCH_START","".concat(Gt,".FETCH_START")),o(zt,"FETCH_COMPLETE","".concat(Gt,".FETCH_COMPLETE")),o(zt,"FETCH_TIMEOUT","".concat(Gt,".FETCH_TIMEOUT")),o(zt,"FETCH_ERROR","".concat(Gt,".FETCH_ERROR")),o(zt,"RESPONSE_PROCESSED","".concat(Gt,".RESPONSE_PROCESSED"));var Wt={},Vt=function(e,t,i){var n=document.createElement("script");n.className="jac-fetch",n.src=e,n.onload=t,n.onerror=i,(document.body||document.head).appendChild(n),Wt[e]=n},Bt=function(e){var t=Wt[e];t&&(t.parentNode.removeChild(t),delete Wt[e])};function Ht(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function Zt(){return Zt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=Ht(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:i):o.value}},Zt.apply(this,arguments)}var Jt=function(){function t(i){e(this,t),o(this,"positionNames",void 0),o(this,"completedPositionNames",[]),o(this,"abortedPositionNames",[]),o(this,"startTime",void 0),o(this,"endTime",void 0),Object.assign(this,i)}return n(t,[{key:"start",value:function(){this.startTime||(this.startTime=(new Date).getTime())}},{key:"end",value:function(){this.endTime||(this.endTime=(new Date).getTime(),this.completedPositionNames=this.completedPositionNames.concat(this.positionNames),this.positionNames=[])}},{key:"isPending",value:function(e){return!(this.endTime||e&&!this.positionNames.includes(e))}},{key:"completePosition",value:function(e){this._movePositionName(e,this.completedPositionNames)}},{key:"abortPosition",value:function(e){this._movePositionName(e,this.abortedPositionNames)}},{key:"isAborted",value:function(){return 0===this.positionNames.length&&this.abortedPositionNames.length>0&&0===this.completedPositionNames.length}},{key:"_movePositionName",value:function(e,t){var i=this.positionNames.indexOf(e);i>-1&&!t.includes(e)&&(t.push(e),this.positionNames.splice(i,1))}}]),t}();function Yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}var qt=function(t){u(o,t);var i=Yt(o);function o(t){var n;return e(this,o),(n=i.call(this,t)).optionsPerPosition=n.optionsPerPosition||{},n}return n(o,[{key:"isPending",value:function(e){return this.status!==He&&Zt(d(o.prototype),"isPending",this).call(this,e)}}]),o}(Jt);function Xt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Kt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Xt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function $t(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}o(qt,"ACTION_NAME","fetch");var Qt={},ei=new(function(){function t(){e(this,t)}return n(t,[{key:"toJACPositions",value:function(e){var t,i=Kt(Kt({},e.ext),{},{positions:{}});return((null===(t=e.seatbid[0])||void 0===t?void 0:t.bid)||[]).forEach((function(e){var t=e.ext.pos;i.positions[t]=i.positions[t]||[],i.positions[t].push(function(e){return{id:e.id,status:e.ext.status,meta:e.ext.meta,content:{markup:e.adm,type:"display",size:{width:e.w,height:e.h,unit:"px"},adId:e.adid,crId:e.crid}}}(e))})),i}}]),t}());var ti=new WeakMap,ii=new WeakMap,ni=function(){function t(i){e(this,t),$t(this,ti,{writable:!0,value:void 0}),$t(this,ii,{writable:!0,value:!0}),o(this,"_fetchActions",Qt),a(this,ti,i)}return n(t,[{key:"process",value:function(){if(void 0!==window.JAC_QUEUE&&window.JAC_QUEUE.length>0){var e=window.JAC_QUEUE.shift(),t=e.client?e.client.requestId:0;e.seatbid&&(e=ei.toJACPositions(e));var i=Qt[t];if(0===t){e.positions=function(e){if(Array.isArray(e)){var t={};return e.forEach((function(e){t[e.name]=e.data})),t}return e}(e.positions);var n=e.positions;(i=new qt({positionNames:Object.keys(n),status:Ve})).start(),this.trigger(new zt(zt.FETCH_START,{prefetched:!0,request:{positions:n}}))}if(i.status!==He){a(this,ii,!1);var o=function(e){return Qt[e]?Qt[e].url:void 0}(t);this.trigger(new zt(zt.RESPONSE_PROCESSED,{response:e,fetchAction:i,url:o}))}return e}return null}},{key:"fetchAds",value:function(e,i){var n=this,o=e.positionNames,r=i.getServiceConfigForFetch(e),a=r.requestId=t.REQUEST_ID++;r.metrics=s(this,ii);var c="".concat(i.service.host).concat("v2/ads/js","?jacVersion=").concat(s(this,ti))+"&config=".concat(encodeURIComponent(JSON.stringify(r)));e.url=c,Qt[a]=e;var u=i.getFetchTimeout(o),l=!1;function h(e){l||(l=!0,clearTimeout(d),setTimeout((function(){Bt(c)}),0),e())}var d=setTimeout((function(){return h((function(){Qt[a].status=He,n.trigger(new zt(zt.FETCH_TIMEOUT,{url:c,positionNames:o}))}))}),u);this.trigger(new zt(zt.FETCH_START,{request:r,url:c})),Vt(c,(function(){return h((function(){n.trigger(new zt(zt.FETCH_COMPLETE,{url:c}))}))}),(function(e){return h((function(){n.trigger(new zt(zt.FETCH_ERROR,{positionNames:o,scriptErrorEvent:e}))}))}))}}]),t}();o(ni,"REQUEST_ID",1),Object.assign(ni.prototype,k);var oi=ni;function ri(e,t){return Math.min(Math.max(e,t.min),t.max)}var si=function(){function t(){e(this,t)}return n(t,null,[{key:"applyConstraints",value:function(e,t){var i=e.width||{},n=e.height||{};t.width.min=ri(i.min||0,t.width),t.width.max=ri(i.max||Number.MAX_VALUE,t.width),t.height.min=ri(n.min||0,t.height),t.height.max=ri(n.max||Number.MAX_VALUE,t.height)}},{key:"computeFlexibleSize",value:function(e,t,i){var n=e.flexible,o=n.width,r=n.height,s={};if(!o.enabled&&!r.enabled)return s;var a={width:"100%",height:"100%"};if(Pe(e.flexible.ratio)){var c=function(e,t,i,n){var o={};if(t.height.enabled){var r=re.getComputedStyle(i),s=e.height/e.width,a=t.width,c=a.enabled?parseInt(r.width):n.width;c=ri(c,a),o.height=ri(c*s,t.height)+"px"}else{var u=e.width/e.height;o.width=n.height*u+"px"}return o}(Ce(e.flexible.ratio),e.flexible,t,i);Ee.copy(c,a)}return o.enabled&&(s.width=a.width,s.minWidth=o.min+"px",s.maxWidth=o.max+"px"),r.enabled&&(s.height=a.height,s.minHeight=r.min+"px",s.maxHeight=r.max+"px"),s}}]),t}();function ai(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}var ci="PositionComponent",ui=function(t){u(o,t);var i=ai(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(p);function li(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}o(ui,"RENDER_START","".concat(ci,".RENDER_START")),o(ui,"RENDER_COMPLETE","".concat(ci,".RENDER_COMPLETE")),o(ui,"RENDER_FAILED","".concat(ci,".RENDER_FAILED")),o(ui,"AD_OPENED","".concat(ci,".AD_OPENED")),o(ui,"AD_CLOSED","".concat(ci,".AD_CLOSED")),o(ui,"AD_LOAD","".concat(ci,".AD_LOAD")),o(ui,"AD_LOAD_TIMEOUT","".concat(ci,".AD_LOAD_TIMEOUT")),o(ui,"NO_AD","".concat(ci,".NO_AD")),o(ui,"COLLAPSED","".concat(ci,".COLLAPSED")),o(ui,"RESIZE","".concat(ci,".RESIZE")),o(ui,"SHOW","".concat(ci,".SHOW")),o(ui,"HIDE","".concat(ci,".HIDE")),o(ui,"DESTROY","".concat(ci,".DESTROY")),o(ui,"VIEW_START","".concat(ci,".VIEW_START")),o(ui,"VIEW_END","".concat(ci,".VIEW_END")),o(ui,"VIEWABLE","".concat(ci,".VIEWABLE")),o(ui,"MOUSE_OUT","".concat(ci,".MOUSE_OUT")),o(ui,"AD_SIZE_CHANGED","".concat(ci,".AD_SIZE_CHANGED")),o(ui,"GEOMETRY_CHANGED","".concat(ci,".GEOMETRY_CHANGED")),o(ui,"AD_META_CHANGED","".concat(ci,".AD_META_CHANGED")),o(ui,"AD_MESSAGE","".concat(ci,".AD_MESSAGE")),o(ui,"SAFE_FRAME_GEOMETRY_CHANGED","".concat(ci,".SAFE_FRAME_GEOMETRY_CHANGED"));var hi="Render",di=function(t){u(o,t);var i=li(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(p);function fi(e,t){var i=e.cookie.split(";").reduce((function(e,i){var n=i.indexOf("="),o=i.substring(0,n).trim();return t===o&&(e=i.substring(n+1)),e}),"");return i||null}function pi(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}o(di,"RENDER_COMPLETE","".concat(hi,".RENDER_COMPLETE")),o(di,"AD_LOAD","".concat(hi,".AD_LOAD")),o(di,"AD_LOAD_TIMEOUT","".concat(hi,".AD_LOAD_TIMEOUT")),o(di,"AD_CLOSED","".concat(hi,".AD_CLOSED")),o(di,"AD_OPENED","".concat(hi,".AD_OPENED"));var vi=new WeakMap,mi=new WeakMap,gi=new WeakMap,Ei=new WeakMap,yi=new WeakMap,_i=function(){function t(i,n){e(this,t),pi(this,vi,{writable:!0,value:void 0}),pi(this,mi,{writable:!0,value:void 0}),pi(this,gi,{writable:!0,value:{}}),pi(this,Ei,{writable:!0,value:[]}),pi(this,yi,{writable:!0,value:void 0}),a(this,vi,i),a(this,mi,n),a(this,yi,n.position.config.client.safeFrame),a(this,gi,Re(s(this,yi))),a(this,Ei,n.position.adData.config.service.sizes||[]),this._toggleEventListeners(!0)}return n(t,[{key:"messenger",get:function(){return s(this,vi)}},{key:"component",get:function(){return s(this,mi)}},{key:"cleanup",value:function(){this._toggleEventListeners(!1),s(this,vi).cleanup()}},{key:"_onSizeChange",value:function(e){var t=e.message.meta,i=t.width,n=t.height,o=t.ratio,r=s(this,mi).position.config.client.flexible;i&&n&&s(this,Ei).includes("".concat(i,"x").concat(n))?s(this,mi).setSize({width:i,height:n}):o&&(r.enabled||r.enabledByAds)&&(s(this,mi).enableFlexible(o),s(this,mi).setSize({ratio:o}))}},{key:"_onConfigRequest",value:function(e){var t=e.message.meta,i=s(this,mi).position.config.client;t.flexible&&(i.flexible.enabled||i.flexible.enabledByAds)&&s(this,mi).updateFlexibleDisplay(t.flexible)}},{key:"_onCloseAd",value:function(e){s(this,mi).closeAd(e.message.meta)}},{key:"_onUnload",value:function(){this.cleanup(),s(this,mi).unloadAd()}},{key:"_onSafeFrameMessage",value:function(e){var t=e.message,i=t.cmd,n=t.meta;if(!1!==s(this,gi)[i])switch(i){case X.cmd.EXPAND_OVER:case X.cmd.EXPAND_PUSH:this._expand(n,i===X.cmd.EXPAND_PUSH),this._sendStatusUpdate(X.status.EXPANDED,{cmd:i});break;case X.cmd.COLLAPSE:this._collapse(),this._sendStatusUpdate(X.status.COLLAPSED,{cmd:i});break;case X.cmd.READ_COOKIE:this._readCookie(n.cookieName);break;case X.cmd.WRITE_COOKIE:this._writeCookie(n.cookieName,n.cookieData);break;case X.cmd.MSG:this._receivedAdMessage(n);break;case X.cmd.RESIZE_TO:this._resizeTo(n)}else this._sendFailure({cmd:i,reason:"Feature not supported by the host."})}},{key:"_expand",value:function(e){var t=e.top,i=e.left,n=e.right,o=e.bottom,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=S.int(t,0,0),i=S.int(i,0,0),n=S.int(n,0,0),o=S.int(o,0,0);var a=s(this,mi).size,c={width:a.width+n+i,height:a.height+o+t};r||(c.dx=-i,c.dy=-t),s(this,mi).updateGeometry(c,r)}},{key:"_collapse",value:function(){s(this,mi).resetGeometry()}},{key:"_resizeTo",value:function(e){var t,i,n=e.width,o=e.height,r=e.ratio;s(this,mi).isFlexible?(t={ratio:r},i={r:r}):(t={width:n=S.int(n,0,0),height:o=S.int(o,0,0)},i={w:n,h:o}),s(this,mi).setSize(t),this._sendStatusUpdate(X.status.RESIZE_TO,{cmd:X.cmd.RESIZE_TO,info:i})}},{key:"_readCookie",value:function(e){var t=X.cmd.READ_COOKIE;if((s(this,yi).features.cookies.allowed||[]).includes(e)){var i=fi(window.document,e);if(!i)(fi(window.document,"SF")||"").split("&").filter((function(t){return 0===t.indexOf(e+"=")})).forEach((function(t){var n=fi({cookie:t},e);i=i||n}));this._sendStatusUpdate(X.status.READ_COOKIE,{cmd:t,info:i})}else this._sendFailure({cmd:t,reason:xe.FailureReason.INVALID_ARGS,info:{key:e}})}},{key:"_writeCookie",value:function(e,t){var i=X.cmd.WRITE_COOKIE;if(t.value&&t.value.length>1e3&&(t.value=t.value.substring(0,1e3)),(s(this,yi).features.cookies.allowed||[]).includes(e)){var n=t.value;fi(window.document,e)||(t.value="".concat(e,"=").concat(t.value),e="SF"),t.expires=t.expires||null,t.expires&&"[object Date]"!==Object.prototype.toString.call(t.expires)&&(t.expires=null),function(e,t,i){if(i&&"string"==typeof i.value){var n=t+"="+i.value;i.expires&&(n+="; expires="+i.expires.toUTCString()),e.cookie=n}}(window.document,e,t),this._sendStatusUpdate(X.status.WRITE_COOKIE,{cmd:i,info:n})}else this._sendFailure({cmd:i,reason:xe.FailureReason.INVALID_ARGS,info:{key:e}})}},{key:"_receivedAdMessage",value:function(e){s(this,mi).adMessageReceived(e)}},{key:"_sendStatusUpdate",value:function(e,t){var i=t.cmd,n=t.reason,o=t.info;this.messenger.send(new X({status:e,meta:{cmd:i,reason:n,info:o}}))}},{key:"_sendFailure",value:function(e){var t=e.cmd,i=e.reason,n=e.info;this._sendStatusUpdate(X.status.FAILED,{cmd:t,reason:i,info:n})}},{key:"positionMetaChanged",value:function(e){s(this,yi)&&s(this,yi).enabled?this._sendStatusUpdate(X.status.META_UPDATE,{info:e.meta.adMeta}):Ne.warning("Messages can be sent only to SafeFrame positions.")}},{key:"_sendSafeFrameGeometryUpdate",value:function(e){s(this,vi).send(new X({status:X.status.GEOMETRY_UPDATE,meta:{info:e.meta}}))}},{key:"_sendSafeFrameFocusUpdate",value:function(e){s(this,vi).send(new X({status:X.status.FOCUS_CHANGE,meta:{info:e.type===m.FOCUS}}))}},{key:"_toggleEventListeners",value:function(e){var t=e?"on":"off",i=s(this,vi),n=s(this,mi),o=n.pageObserver;i[t](V.topic.SIZE,this._onSizeChange,this),i[t](V.topic.UNLOAD,this._onUnload,this),i[t](V.topic.CLOSE_AD,this._onCloseAd,this),i[t](V.topic.CONFIG,this._onConfigRequest,this),i[t](X.topic.SAFE_FRAME,this._onSafeFrameMessage,this),n[t](ui.DESTROY,this.cleanup,this),n[t](ui.SAFE_FRAME_GEOMETRY_CHANGED,this._sendSafeFrameGeometryUpdate,this),n[t](ui.AD_META_CHANGED,this.positionMetaChanged,this),o[t](m.FOCUS,this._sendSafeFrameFocusUpdate,this),o[t](m.BLUR,this._sendSafeFrameFocusUpdate,this)}}]),t}();function wi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Oi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?wi(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):wi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function bi(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}var Ai=l("1.3.0")!==A?"1.3.0":"0.0.0",Ti="https://jac.yahoosandbox.com";function Ri(){return Math.floor(1e7*Math.random()).toString()}function Si(e,t,i){var n=t.sandbox,o=window.JAC_SANDBOX_BASE_URL||n.baseUrl||e.clientBaseUrl||Ti;return n.uniqueDomain&&(o=o.replace("https://","https://j".concat(Ri(),"."))),"".concat(o,"/").concat(Ai,"/").concat(i)}function Pi(e,t){var i,n,o={id:"jacSandbox_"+Ri(),name:JSON.stringify(e),title:"Advertisement",itemtype:"https://schema.org/WPAdBlock",itemscope:"",tabindex:"-1",allowtransparency:"true",scrolling:"no"},r=t.sandbox;r&&(o.sandbox=r.allow.map((function(e){return"allow-".concat(e)})).join(" "),o.allow=(i=r.features,n=[],Object.keys(i).forEach((function(e){var t=i[e];if(t.enabled){var o=[];o.push(e),t.allow&&t.allow.forEach((function(e){0===(e=e.trim()).indexOf("https:")?o.push(e):0===e.indexOf("http:")?o.push(e.replace("http:","https:")):o.push("https://"+e)})),n.push(o.join(" "))}})),n.join(";")),r.features.fullscreen.enabled&&(o.allowfullscreen=!0));var s=document.createElement("iframe");Object.keys(o).forEach((function(e){s.setAttribute(e,o[e])}));var a=e.adData.content.size,c=a.width,u=a.height;return re.setStyles(s,{position:"absolute",top:"0",left:"0",width:"".concat(c,"px"),height:"".concat(u,"px"),border:"0",overflow:"hidden",zIndex:t.layout.zIndex}),s}function Ci(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=e.children,n=i.length-1;n>=0;n--)i[n]!==t&&e.removeChild(i[n])}function Di(e,t,i){var n=t.containerType;if(n===Ye)!function(e,t){var i=e.contentWindow.document;i.open(),i.write('<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>html,body{margin:0;padding:0;width:100%;height:100%}</style></head><body><script src="'+t+'"><\/script><script>var inFIF=true,inDapIF=true;<\/script></body></html>'),i.close()}(e,function(e){var t=window.JAC_BASE_URL||e.clientBaseUrl||Ti;return"".concat(t,"/").concat(Ai,"/jac.js")}(i));else{var o=t.config.client;n===Ze?e.src=Si(i,o,"safeframe.html"):n===Je&&(e.src=Si(i,o,"sandbox.html"))}}function ki(e){return e.navigator.userAgent.includes("Trident/")}var Ii=new WeakMap,Ni=new WeakMap,Li=new WeakMap,Mi=new WeakMap,xi=new WeakMap,Fi=new WeakMap,ji=new WeakMap,Ui=new WeakMap,Gi=new WeakMap,zi=new WeakMap,Wi=new WeakMap,Vi=new WeakMap,Bi=new WeakMap,Hi=function(){function t(i){e(this,t),bi(this,Ii,{writable:!0,value:void 0}),bi(this,Ni,{writable:!0,value:void 0}),bi(this,Li,{writable:!0,value:void 0}),bi(this,Mi,{writable:!0,value:void 0}),bi(this,xi,{writable:!0,value:void 0}),bi(this,Fi,{writable:!0,value:void 0}),bi(this,ji,{writable:!0,value:void 0}),bi(this,Ui,{writable:!0,value:void 0}),bi(this,Gi,{writable:!0,value:void 0}),bi(this,zi,{writable:!0,value:void 0}),bi(this,Wi,{writable:!0,value:void 0}),bi(this,Vi,{writable:!0,value:void 0}),bi(this,Bi,{writable:!0,value:!0}),a(this,Ii,i)}return n(t,[{key:"render",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,n=s(this,Ii).position,o=n.config.client,r=o.render;this._setupRenderingDOM(e);var c=s(this,Fi);if(a(this,Ui,setTimeout((function(){t._onAdLoadTimeOut()}),r.timeout)),r.delayedLoadInLegacyIE&&ki(i))return a(this,Vi,(function(){c.removeEventListener("load",s(t,Vi),!1),Di(c,n,e)})),void c.addEventListener("load",s(this,Vi),!1);Di(c,n,e),a(this,Bi,!1)}},{key:"clear",value:function(){this._cleanupRenderingSandbox(),this._cleanupRenderedSandbox(),Ci(s(this,Ii).element)}},{key:"reset",value:function(){this._cleanupRenderingSandbox(),this._cleanupRenderedSandbox(),s(this,Ii).element.parentNode.removeChild(s(this,Ii).element),s(this,Wi)&&s(this,zi)&&s(this,zi).removeEventListener("click",s(this,Wi))}},{key:"refreshFlexibleSize",value:function(e,t){var i=s(this,Ii).element;if(Pe(t.ratio)){var n=si.computeFlexibleSize({flexible:Oi({},t)},i.parentNode,e);re.setStyles(i,n),this._forAllIframes((function(e){return re.setStyles(e,n)}))}}},{key:"_resetFlexibleConstraints",value:function(){var e=s(this,Ii).element;re.setStyles(e,{minWidth:null,maxWidth:null,minHeight:null,maxHeight:null})}},{key:"resize",value:function(e){var t=e.width,i=e.height,n=e.top,o=void 0===n?0:n,r=e.left,a=void 0===r?0:r;e.resizeContainer&&re.setStyles(s(this,Ii).element,{position:"relative",width:"".concat(t,"px"),height:"".concat(i,"px")}),this._forAllIframes((function(e){return re.setStyles(e,{width:"".concat(t,"px"),height:"".concat(i,"px"),top:"".concat(o,"px"),left:"".concat(a,"px")})}))}},{key:"iframe",get:function(){return s(this,Li)}},{key:"renderingSandbox",get:function(){return s(this,ji)}},{key:"adClosed",get:function(){return s(this,Gi)}},{key:"showButton",get:function(){return s(this,zi)}},{key:"closeAd",value:function(e){var t=this,i=e.closeConfig,n=e.adSize;if(!s(this,Gi)){a(this,Gi,!0);var o=0;i.showButtonEnabled&&(o=26),this._toggleCloseShowAd(i,o,(function(){t.showClosedAd(i,o,n)}))}}},{key:"showClosedAd",value:function(e,t,i){var n=this;if(this._forAllContainers((function(e){return re.setStyles(e,{display:"none"})})),re.setStyles(s(this,Ii).element,{height:"".concat(t,"px")}),this.trigger(new di(di.AD_CLOSED)),e.showButtonEnabled){var o=H.createOpenAdButton(e.labels.show,i.width);a(this,zi,o),s(this,Wi)||a(this,Wi,(function(){n.showAd(e)})),o.addEventListener("click",s(this,Wi),!1),s(this,Ii).element.appendChild(o)}}},{key:"showAd",value:function(e){var t=this;this._cleanupCloseAdButton(),this._forAllContainers((function(e){return re.setStyles(e,{display:"block"})}));var i=s(this,Ii).size.height;this._toggleCloseShowAd(e,i,(function(){a(t,Gi,!1),re.setStyles(s(t,Ii).element,{overflow:null,transition:null}),t.trigger(new di(di.AD_OPENED))}))}},{key:"_cleanupCloseAdButton",value:function(){s(this,zi)&&(s(this,zi).removeEventListener("click",s(this,Wi)),s(this,zi).parentNode.removeChild(s(this,zi)),a(this,zi,null),a(this,Wi,null))}},{key:"_resetClosedAd",value:function(e){s(this,Gi)&&(this._cleanupCloseAdButton(),a(this,Gi,!1),re.setStyles(s(this,Ii).element,{height:"".concat(e,"px"),overflow:null,transition:null}))}},{key:"_toggleCloseShowAd",value:function(e,t,i){e.animation&&!0===e.animation.enabled?(re.setStyles(s(this,Ii).element,{overflow:"hidden",height:"".concat(t,"px"),transition:"height ".concat(e.animation.duration,"ms linear")}),setTimeout((function(){i()}),e.animation.duration)):(re.setStyles(s(this,Ii).element,{height:"".concat(t,"px")}),i())}},{key:"_cleanupSandbox",value:function(e,t,i){e&&e.cleanup(),this._removeIframeListeners(t),Ci(s(this,Ii).element,i)}},{key:"_cleanupRenderedSandbox",value:function(){this._cleanupSandbox(s(this,Mi),s(this,Li),s(this,xi)),a(this,Mi,null),a(this,Ni,null),a(this,Li,null)}},{key:"_cleanupRenderingSandbox",value:function(){clearTimeout(s(this,Ui)),a(this,Ui,null),this._cleanupSandbox(s(this,ji),s(this,Fi),s(this,Ni)),a(this,ji,null),a(this,xi,null),a(this,Fi,null)}},{key:"_setupRenderingDOM",value:function(e){var t,i,n=s(this,Ii).element,o=s(this,Ii).position,r=o.config.client,c=r.render,u=r.placeholder,l={adData:e,token:Ri()};if(o.containerType===Ze&&(l.safeFrame={geom:(t=s(this,Ii)).safeFrameGeometry.buildGeometry(),focus:t.pageObserver.hasFocus,meta:t.position.config.client.meta}),u.enabled){var h='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">'+'<rect width="100%" height="100%" fill="'.concat((i=u).backgroundColor,'"/>')+'<text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" '+'fill="'.concat(i.textColor,'" ')+'font-family="Arial, Helvetica, sans-serif" '+'font-size="'.concat(i.fontSize,'">')+i.text+"</text></svg>";re.setStyles(n,{backgroundImage:"url(data:image/svg+xml;base64,".concat(btoa(h),")")})}this._resetFlexibleConstraints(),s(this,xi)&&this._cleanupRenderingSandbox();var d=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!e.render.doubleBuffering||t,n=document.createElement("div");return re.setStyles(n,{display:i?"block":"none"}),n}(r,s(this,Bi)),f=Pi(l,r);if(c.doubleBuffering||(this._resetClosedAd(e.content.size.height),this._cleanupRenderedSandbox()),r.flexible.enabled){var p=si.computeFlexibleSize(r,n.parentNode,l.adData.content.size);re.setStyles(f,p),re.setStyles(n,p)}d.appendChild(f),n.appendChild(d),a(this,ji,function(e,t,i,n){var o=new oe(e.contentWindow,t.token);return o.listen(),o.on(V.topic.WRITE_COMPLETE,(function(){e.removeAttribute("name"),n.trigger(new di(di.RENDER_COMPLETE))})),o.on(V.topic.PAGE_LOAD,(function(){n._onAdLoaded()})),o.on(V.topic.UNLOAD,(function(){n._onUnload()})),new _i(o,i)}(f,l,s(this,Ii),this)),a(this,xi,d),a(this,Fi,f)}},{key:"_onAdLoaded",value:function(){clearTimeout(s(this,Ui)),a(this,Ui,null),this._removeIframeListeners(s(this,Fi)),this._resetClosedAd(s(this,Ii).size.height),this._cleanupRenderedSandbox(),a(this,Mi,s(this,ji)),a(this,Ni,s(this,xi)),a(this,Li,s(this,Fi)),a(this,ji,null),a(this,xi,null),a(this,Fi,null),re.setStyles(s(this,Ni),{display:"block"}),this.trigger(new di(di.AD_LOAD))}},{key:"_onAdLoadTimeOut",value:function(){this._cleanupRenderingSandbox(),this.trigger(new di(di.AD_LOAD_TIMEOUT))}},{key:"_onUnload",value:function(){this._cleanupRenderingSandbox()}},{key:"_removeIframeListeners",value:function(e){s(this,Vi)&&e&&e.removeEventListener("load",s(this,Vi),!1)}},{key:"_forAllContainers",value:function(e){this._forAllElements([s(this,Ni),s(this,xi)],e)}},{key:"_forAllIframes",value:function(e){this._forAllElements([s(this,Li),s(this,Fi)],e)}},{key:"_forAllElements",value:function(e,t){e.forEach((function(e){e&&t(e)}))}}],[{key:"create",value:function(e){return new t(e)}}]),t}();Object.assign(Hi.prototype,k);var Zi=Hi,Ji=function(){function t(i){var n=i.t,r=void 0===n?0:n,s=i.l,a=void 0===s?0:s,c=i.r,u=void 0===c?0:c,l=i.b,h=void 0===l?0:l;e(this,t),o(this,"offsetTop",void 0),o(this,"offsetLeft",void 0),o(this,"offsetBottom",void 0),o(this,"offsetRight",void 0),o(this,"width",void 0),o(this,"height",void 0),this.offsetTop=r,this.offsetLeft=a,this.offsetRight=u,this.offsetBottom=h,this.width=Math.max(this.offsetRight-this.offsetLeft,0),this.height=Math.max(this.offsetBottom-this.offsetTop,0)}return n(t,[{key:"normalize",value:function(){this.offsetTop=Math.max(this.offsetTop,0),this.offsetLeft=Math.max(this.offsetLeft,0),this.offsetRight=Math.max(this.offsetRight,0),this.offsetBottom=Math.max(this.offsetBottom,0),this.width=Math.max(this.offsetRight-this.offsetLeft,0),this.height=Math.max(this.offsetBottom-this.offsetTop,0)}},{key:"toSafeFrameClip",value:function(){return{t:this.offsetTop,l:this.offsetLeft,r:this.offsetRight,b:this.offsetBottom,w:this.width,h:this.height}}},{key:"getOffsetDifference",value:function(e){var t={top:0,right:0,bottom:0,left:0};return this.offsetTop>e.offsetTop&&this.offsetTop<e.offsetBottom&&(t.top=this.offsetTop-e.offsetTop),this.offsetLeft>e.offsetLeft&&this.offsetLeft<e.offsetRight&&(t.left=this.offsetLeft-e.offsetLeft),this.offsetRight<e.offsetRight&&this.offsetRight>e.offsetLeft&&(t.right=e.offsetRight-this.offsetRight),this.offsetBottom<e.offsetBottom&&this.offsetBottom>e.offsetTop&&(t.bottom=e.offsetBottom-this.offsetBottom),t}},{key:"addHorizontalClipping",value:function(e,t){e>this.offsetLeft&&(this.offsetLeft=e),t<this.offsetRight&&(this.offsetRight=t)}},{key:"addVerticalClipping",value:function(e,t){e>this.offsetTop&&(this.offsetTop=e),t<this.offsetBottom&&(this.offsetBottom=t)}}]),t}();function Yi(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}function qi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=fe.getElementGeometry(e,t),n=fe.getPageScrollInfo(),o={t:i.top,l:i.left,r:i.right,b:i.bottom,w:i.width,h:i.height,z:i.zIndex};return(n.y||n.x)&&(o.l+=n.x,o.t+=n.y),o.b=o.t+i.height,o.r=o.l+i.width,Object.keys(o).forEach((function(e){"number"==typeof o[e]&&(o[e]=Math.round(o[e]))})),o}function Xi(){var e=fe.getPageScrollInfo(),t=fe.getWindowGeometry();return{t:e.y,l:e.x,r:e.x+t.width,b:e.y+t.height,w:t.width,h:t.height}}function Ki(e,t,i){for(var n,o,r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window,a=20,c=fe.getPageScrollInfo(),u=re.getComputedStyle(e,null,s);u;){var l="block"===u.display||"absolute"===u.position||"none"!==u.float,h=e===i;if(l){var d=qi(e,s),f=d.t,p=d.l,v=d.r,m=d.b,g=e.offsetWidth,E=e.offsetHeight,y=e.clientWidth,_=e.clientHeight;if(!n&&g>y){var w=g-y;n=w<=a?w:0}if(!o&&E>_){var O=E-_;o=O<=a?O:0}h?(e.scrollWidth>y&&(p=0,v=(window.innerWidth||g)+c.x,window.innerWidth&&window.innerWidth>y&&(v-=window.innerWidth-y),t.addHorizontalClipping(p,v)),e.scrollHeight>_&&(f=0,m=(window.innerHeight||E)+c.y,window.innerHeight&&window.innerHeight>_&&(m-=window.innerHeight-_),t.addVerticalClipping(f,m))):(n&&v-p===g&&(v-=n),o&&m-f===E&&(m-=o),fe.isClippingElement(e,"X",u)&&t.addHorizontalClipping(p,v),fe.isClippingElement(e,"Y",u)&&t.addVerticalClipping(f,m),!r&&fe.isScrollableElement(e,u)&&(r=e))}if(h)break;if((e=e.parentNode)&&Node.DOCUMENT_FRAGMENT_NODE===e.nodeType&&(e=e.parentNode),!e)break;u=re.getComputedStyle(e,null,s)}return{scrollParent:r,xScrollBarHeight:o,yScrollBarWidth:n}}var $i=new WeakMap,Qi=new WeakMap,en=new WeakMap,tn=new WeakMap,nn=function(){function t(i,n){var o=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;e(this,t),Yi(this,$i,{writable:!0,value:void 0}),Yi(this,Qi,{writable:!0,value:void 0}),Yi(this,en,{writable:!0,value:void 0}),Yi(this,tn,{writable:!0,value:void 0}),a(this,$i,i),a(this,Qi,n),a(this,en,r),a(this,tn,E((function(){return o.dispatchGeometryChange()}),1e3)),s(this,$i).on(m.SCROLL,s(this,tn)),s(this,$i).on(m.RESIZE,s(this,tn))}return n(t,[{key:"buildGeometry",value:function(){return{win:this.buildWindowGeometry(),self:this.buildSelfGeometry(),exp:this.buildExpandableGeometry(),par:this.buildParentGeometry()}}},{key:"winHasFocus",value:function(){return s(this,$i).hasFocus}},{key:"dispatchGeometryChange",value:function(){this.trigger(new p(t.GEOMETRY_UPDATE,this.buildGeometry()))}},{key:"destroy",value:function(){s(this,$i).off(m.SCROLL,s(this,tn)),s(this,$i).off(m.RESIZE,s(this,tn))}},{key:"buildWindowGeometry",value:function(){var e=fe.getWindowGeometry();return{t:e.top,l:e.left,r:e.right,b:e.bottom,w:e.width,h:e.height}}},{key:"buildSelfGeometry",value:function(){var e=s(this,en),t=qi(s(this,Qi),e),i=fe.getVisibilityMetrics(s(this,Qi),e);return t.xiv=parseFloat(i.xPercentage.toFixed(2)),t.yiv=parseFloat(i.yPercentage.toFixed(2)),t.iv=parseFloat(i.totalPercentage.toFixed(2)),t}},{key:"buildExpandableGeometry",value:function(){var e=s(this,en),t=qi(s(this,Qi),e),i=fe.getDocumentElement(),n=Xi(),o=new Ji(n),r=Ki(s(this,Qi),o,i,e);o.normalize();var a=new Ji(t).getOffsetDifference(o),c={t:a.top,l:a.left,r:a.right,b:a.bottom};return r.scrollParent?(c.xs=!!r.xScrollBarHeight,c.ys=!!r.yScrollBarWidth):(c.xs=i.scrollWidth>i.clientWidth,c.ys=i.scrollHeight>i.clientHeight),c}},{key:"buildParentGeometry",value:function(){var e=s(this,en),t=fe.getDocumentElement(),i=Xi(),n=new Ji(i),o=Ki(s(this,Qi),n,t,e);if(o.scrollParent){var r=qi(o.scrollParent,e),a=new Ji(r);return Ki(o.scrollParent,a,t,e),a.addHorizontalClipping(i.l,i.r),a.addVerticalClipping(i.t,i.b),a.normalize(),a.toSafeFrameClip()}return n.normalize(),n.toSafeFrameClip()}},{key:"element",set:function(e){a(this,Qi,e)}}]),t}();o(nn,"GEOMETRY_UPDATE","GEOMETRY_UPDATE"),Object.assign(nn.prototype,k);var on=nn;function rn(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}var sn=new WeakMap,an=function(){function t(i){var n=i.time,r=i.limit,s=i.callback;e(this,t),o(this,"time",void 0),o(this,"limit",void 0),o(this,"remaining",void 0),o(this,"callback",void 0),rn(this,sn,{writable:!0,value:void 0}),this.time=n,this.remaining=this.limit=r,this.callback=s}return n(t,[{key:"start",value:function(){var e=this;(!S.isSet(this.remaining)||this.remaining>0)&&a(this,sn,setTimeout((function(){S.isSet(e.remaining)&&e.remaining--,e.callback()}),this.time))}},{key:"stop",value:function(){clearTimeout(s(this,sn))}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"reset",value:function(){this.stop(),this.remaining=this.limit}}]),t}();function cn(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}var un=new WeakMap,ln=new WeakMap,hn=new WeakMap,dn=new WeakMap,fn=new WeakMap,pn=new WeakMap,vn=new WeakMap,mn=new WeakMap,gn=new WeakMap,En=new WeakMap,yn=new WeakMap,_n=new WeakMap,wn=new WeakMap,On=new WeakMap,bn=new WeakMap,An=new WeakMap,Tn=new WeakMap,Rn=function(){function t(i,n){var r=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;e(this,t),cn(this,un,{writable:!0,value:void 0}),cn(this,ln,{writable:!0,value:void 0}),cn(this,hn,{writable:!0,value:void 0}),cn(this,dn,{writable:!0,value:void 0}),cn(this,fn,{writable:!0,value:void 0}),cn(this,pn,{writable:!0,value:void 0}),cn(this,vn,{writable:!0,value:!1}),cn(this,mn,{writable:!0,value:!1}),cn(this,gn,{writable:!0,value:!1}),cn(this,En,{writable:!0,value:!1}),cn(this,yn,{writable:!0,value:!1}),cn(this,_n,{writable:!0,value:void 0}),cn(this,wn,{writable:!0,value:void 0}),cn(this,On,{writable:!0,value:void 0}),cn(this,bn,{writable:!0,value:void 0}),cn(this,An,{writable:!0,value:void 0}),cn(this,Tn,{writable:!0,value:{enabled:!1,ratio:""}}),o(this,"position",void 0),o(this,"element",void 0),o(this,"renderer",void 0),o(this,"safeFrameGeometry",void 0),this.position=i,this._createContainerNode(),a(this,un,n),a(this,bn,s),this.renderer=Zi.create(this),this.renderer.on(di.RENDER_COMPLETE,this._onRenderComplete,this),this.renderer.on(di.AD_LOAD,this._onAdLoad,this),this.renderer.on(di.AD_LOAD_TIMEOUT,this._onAdLoadTimeOut,this),this.renderer.on(di.AD_OPENED,this._onAdOpened,this),this.renderer.on(di.AD_CLOSED,this._onAdClosed,this),a(this,fn,(function(){return r._onMouseOver()})),a(this,pn,(function(){return r._onMouseOut()})),this._addElementListeners(),i.containerType===Ze&&this._addSafeFrameGeometry()}return n(t,[{key:"_createContainerNode",value:function(){var e=this.position.config.getTargetElement(),t=document.createElement("div");t.id="jacPosition_".concat(this.position.name),t.className="jac-container",e.innerHTML="",e.appendChild(t),this.element=t}},{key:"_addSafeFrameGeometry",value:function(){var e=this;this.safeFrameGeometry||(this.safeFrameGeometry=new on(s(this,un),this.element,s(this,bn)),a(this,An,(function(t){e.position.containerType===Ze&&e._triggerEvent(ui.SAFE_FRAME_GEOMETRY_CHANGED,t.meta)})),this.safeFrameGeometry.on(on.GEOMETRY_UPDATE,s(this,An),this))}},{key:"_removeSafeFrameGeometry",value:function(){this.safeFrameGeometry&&(this.safeFrameGeometry.destroy(),this.safeFrameGeometry.off(on.GEOMETRY_UPDATE,s(this,An),this),this.safeFrameGeometry=null)}},{key:"render",value:function(){var e=this;this._refreshTargetContainerIfChanged(),a(this,gn,!0),a(this,En,!1),a(this,Tn,Ee.clone(this.position.config.client.flexible));var t=a(this,ln,this.position.adData);this.position.updateContainerType(t.meta),this.position.containerType===Ze?this._addSafeFrameGeometry():this._removeSafeFrameGeometry(),!s(this,hn)&&s(this,un)&&(a(this,hn,(function(){return e._pageStateChanged()})),a(this,dn,(function(){return e._pageResizeListener()})),s(this,un).on(m.SCROLL,s(this,hn)),s(this,un).on(m.RESIZE,s(this,dn)),s(this,un).on(m.VISIBILITY,s(this,hn)),s(this,un).on(m.FOCUS,s(this,hn)),s(this,un).on(m.BLUR,s(this,hn))),this._pageStateChanged(),this.position.config.client.render.requireViewable||this._processAndInjectAd()}},{key:"_processAndInjectAd",value:function(){var e=s(this,ln);a(this,gn,!1),this._triggerEvent(ui.RENDER_START),e.status===Be||e.status===Ve?this.position.config.client.render.abortOnFocus&&this.isFocused||this.position.config.client.render.abortOnMouseOver&&this.hasMouseOver||this.position.config.client.render.abortOnExpandedAd&&this.isExpanded?this._triggerEvent(ui.RENDER_FAILED):(e.status===Be&&(e.content.size={width:1,height:1,unit:"px"},this._triggerEvent(ui.NO_AD),this.position.config.client.render.doubleBuffering||this._triggerEvent(ui.COLLAPSED)),pe.isMobileMomentAd(e)&&(e.content.size=pe.computeDisplaySize(this.position)),this.setSize(e.content.size),this.show(),this.renderer.render(e),s(this,Tn).enabled&&this.setSize({ratio:s(this,Tn).ratio})):this._triggerEvent(ui.RENDER_FAILED)}},{key:"_refreshTargetContainerIfChanged",value:function(){if(this.position.config.getTargetElement()!==this.element.parentNode){var e=this.element;this._cleanElementListeners(),this.renderer.reset(),this._createContainerNode(),this._addElementListeners(),this.safeFrameGeometry&&(this.safeFrameGeometry.element=this.element),re.setStyles(this.element,{display:e.style.display,position:e.style.position,width:e.style.width,height:e.style.height})}}},{key:"show",value:function(){re.setStyles(this.element,{display:"block"}),this._triggerEvent(ui.SHOW)}},{key:"hide",value:function(){this._triggerEvent(ui.HIDE)}},{key:"destroy",value:function(){s(this,un).off(m.SCROLL,s(this,hn)),s(this,un).off(m.RESIZE,s(this,dn)),s(this,un).off(m.VISIBILITY,s(this,hn)),this.renderer.off(di.RENDER_COMPLETE,this._onRenderComplete,this),this.renderer.off(di.AD_LOAD,this._onAdLoad,this),this.renderer.off(di.AD_LOAD_TIMEOUT,this._onAdLoadTimeOut,this),this.renderer.off(di.AD_OPENED,this._onAdOpened,this),this.renderer.off(di.AD_CLOSED,this._onAdClosed,this),this._cleanElementListeners(),this.renderer.reset(),this.safeFrameGeometry&&this._removeSafeFrameGeometry(),this._triggerEvent(ui.DESTROY)}},{key:"_addElementListeners",value:function(){this.element.addEventListener("mouseover",s(this,fn)),this.element.addEventListener("mouseout",s(this,pn))}},{key:"_cleanElementListeners",value:function(){this.element.removeEventListener("mouseover",s(this,fn)),this.element.removeEventListener("mouseout",s(this,pn))}},{key:"abortRender",value:function(){this.hide(),this.clearAd(),a(this,wn,null),a(this,mn,!1),a(this,vn,!1)}},{key:"clearAd",value:function(){this.renderer.clear()}},{key:"unloadAd",value:function(){this._triggerEvent(ui.NO_AD),this.position.config.client.render.doubleBuffering||(this.setSize({width:1,height:1,unit:"px"}),this.abortRender(),this._triggerEvent(ui.COLLAPSED))}},{key:"updateGeometry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a(this,vn,!0),this.renderer.resize({width:e.width,height:e.height,top:e.dy||0,left:e.dx||0,resizeContainer:t});var i=this.getGeometry();this._triggerEvent(ui.RESIZE,i)}},{key:"resetGeometry",value:function(){if(a(this,vn,!1),s(this,wn)){this.renderer.resize({width:s(this,wn).width,height:s(this,wn).height,top:0,left:0,resizeContainer:!0});var e=this.getGeometry();this._triggerEvent(ui.RESIZE,e)}}},{key:"getGeometry",value:function(){return fe.getElementGeometry(this.element)}},{key:"_isAreaInView",value:function(){var e=this.position.config.client.viewability,t=e.percent/100,i=fe.getVisibilityMetrics(this.element,s(this,bn)),n=i.totalPercentage>=t,o=0;return e.pixels>0&&(o=i.totalPercentage*i.containerPixels),n||e.pixels>0&&o>=e.pixels}},{key:"isInView",get:function(){return s(this,yn)}},{key:"isExpanded",get:function(){return s(this,vn)}},{key:"hasMouseOver",get:function(){return s(this,mn)}},{key:"adClosed",get:function(){return this.renderer.adClosed}},{key:"isFocused",get:function(){return this.renderer&&this.renderer.iframe&&document.activeElement===this.renderer.iframe}},{key:"size",get:function(){return s(this,wn)||{}}},{key:"lastAdSize",get:function(){return s(this,On)}},{key:"enableFlexible",value:function(e){s(this,Tn).enabled=!0,s(this,Tn).ratio=e}},{key:"isFlexible",get:function(){return s(this,Tn).enabled}},{key:"setSize",value:function(e){if(!pe.isMobileMomentAd(s(this,ln))){var t=e.width&&e.height;if(this.isFlexible&&(e.ratio||!e.width||!e.height)){s(this,Tn).ratio=e.ratio,this.renderer.refreshFlexibleSize(s(this,ln).content.size,s(this,Tn));var i=this.getGeometry();e={width:i.width,height:i.height}}(!s(this,wn)||s(this,wn).width!==e.width||s(this,wn).height!==e.height)&&(a(this,wn,e),e.width>1&&e.height>1&&s(this,ln).config.service.sizes&&s(this,ln).config.service.sizes.includes("".concat(e.width,"x").concat(e.height))&&a(this,On,e),t&&this.renderer.resize({width:e.width,height:e.height,resizeContainer:!0}),this._triggerEvent(ui.AD_SIZE_CHANGED,s(this,wn)))}}},{key:"_pageResizeListener",value:function(){s(this,Tn).enabled&&this.setSize({ratio:s(this,Tn).ratio}),this._pageStateChanged()}},{key:"_pageStateChanged",value:function(){var e=this.position.config.client,t=s(this,un),i=t.isVisible&&t.hasFocus,n=t.isVisible&&this._isAreaInView();this._changeViewabilityState(n),e.render.requireViewable&&s(this,gn)&&n?this._processAndInjectAd():e.viewability.clearOnPageInactive&&!i&&this.clearAd(),this._triggerEvent(ui.GEOMETRY_CHANGED)}},{key:"_changeViewabilityState",value:function(e){e!==s(this,yn)&&(a(this,yn,e),this._fireVisibilityEvent(e),s(this,_n)&&(e&&s(this,En)?s(this,_n).restart():s(this,_n).stop()))}},{key:"_fireVisibilityEvent",value:function(e){var t=e?ui.VIEW_START:ui.VIEW_END;this._triggerEvent(t)}},{key:"_onRenderComplete",value:function(){var e=this;a(this,En,!0),this._triggerEvent(ui.RENDER_COMPLETE,s(this,wn)),s(this,_n)?s(this,_n).reset():a(this,_n,new an({time:this.position.config.client.viewability.duration,limit:1,callback:function(){return e._triggerEvent(ui.VIEWABLE)}})),s(this,yn)&&s(this,_n).restart()}},{key:"_onAdClosed",value:function(){this._triggerEvent(ui.AD_CLOSED)}},{key:"_onAdOpened",value:function(){this._triggerEvent(ui.AD_OPENED)}},{key:"_onAdLoad",value:function(){this._triggerEvent(ui.AD_LOAD)}},{key:"_onAdLoadTimeOut",value:function(){this._triggerEvent(ui.AD_LOAD_TIMEOUT)}},{key:"_onMouseOver",value:function(){a(this,mn,!0)}},{key:"_onMouseOut",value:function(){a(this,mn,!1),this._triggerEvent(ui.MOUSE_OUT)}},{key:"_triggerEvent",value:function(e,t){this.trigger(new ui(e,Object.assign({positionName:this.position.name},t)))}},{key:"closeAd",value:function(e){this.renderer.closeAd(e)}},{key:"updateMeta",value:function(){var e=this.position.config.client.meta;this._triggerEvent(ui.AD_META_CHANGED,{adMeta:e})}},{key:"adMessageReceived",value:function(e){this._triggerEvent(ui.AD_MESSAGE,{message:e})}},{key:"updateFlexibleDisplay",value:function(e){si.applyConstraints(e,s(this,Tn)),this.isFlexible&&this.renderer.refreshFlexibleSize(s(this,ln).content.size,s(this,Tn))}},{key:"pageObserver",get:function(){return s(this,un)}}]),t}();Object.assign(Rn.prototype,k);var Sn=Rn;function Pn(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}function Cn(e){return e&&"IFRAME"===e.tagName&&e.id&&0===e.id.indexOf("jacSandbox_")}var Dn=new WeakMap,kn=new WeakMap,In=function(){function t(){e(this,t),o(this,"focusedElement",void 0),o(this,"iframeMouseOver",!1),Pn(this,Dn,{writable:!0,value:void 0}),Pn(this,kn,{writable:!0,value:void 0})}return n(t,[{key:"init",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;!s(this,kn)&&t._config.client.focusProtection&&(a(this,kn,e),a(this,Dn,i),this.focusedElement=i.document.activeElement,e.on(m.BLUR_CAPTURE,this._onPageBlurCapture,this),e.on(m.FOCUS_IN,this._onPageFocusIn,this),e.on(m.MOUSE_OVER,this._onMouseOver,this),e.on(m.MOUSE_OUT,this._onMouseOut,this))}},{key:"pageObserver",get:function(){return s(this,kn)}},{key:"_onPageBlurCapture",value:function(e){var i=this;setTimeout((function(){var n=s(i,Dn).document,o=Cn(n.activeElement);o||e.target===s(i,Dn)||i.focusedElement===n.activeElement||(i.focusedElement=null),o&&!i.iframeMouseOver&&(i.focusedElement&&i.focusedElement!==s(i,Dn)&&i.focusedElement!==n.body?i.focusedElement.focus():(i._createFocusPlaceHolder(),t.FOCUS_PLACE_HOLDER.focus(),s(i,Dn).focus()))}),0)}},{key:"_createFocusPlaceHolder",value:function(){if(!t.FOCUS_PLACE_HOLDER){var e=s(this,Dn).document,i=t.FOCUS_PLACE_HOLDER=e.createElement("span");i.tabIndex=-1,e.body.insertBefore(i,e.body.firstChild)}}},{key:"_onPageFocusIn",value:function(e){"IFRAME"!==e.meta.nativeEvent.target.tagName&&(this.focusedElement=e.meta.nativeEvent.target)}},{key:"_onMouseOver",value:function(e){Cn(e.meta.nativeEvent.target)&&(this.iframeMouseOver=!0)}},{key:"_onMouseOut",value:function(e){Cn(e.meta.nativeEvent.target)&&(this.iframeMouseOver=!1)}}]),t}();function Nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}o(In,"FOCUS_PLACE_HOLDER",void 0);var Ln=function(t){u(o,t);var i=Nn(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(p);function Mn(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}function xn(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"log",t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];Ne[e].apply(Ne,["JAC Rotation Scheduler:"].concat(i))}function Fn(e){xn("warning",e)}function jn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];xn.apply(void 0,["debug"].concat(t))}o(Ln,"ROTATION","Scheduler.ROTATION"),o(Ln,"ROTATION_PREVENTED","Scheduler.ROTATION_PREVENTED"),o(Ln,"ROTATION_PREVENTED_REASONS",{RenderNotComplete:"RenderNotComplete",MouseOver:"MouseOver",PageHidden:"PageHidden",PageNotFocused:"PageNotFocused",Expanded:"Expanded",NotInView:"NotInView",BelowInViewDuration:"BelowInViewDuration"});var Un=new WeakMap,Gn=function(){function t(i){e(this,t),Mn(this,Un,{writable:!0,value:void 0}),o(this,"schedulerRegistry",{}),o(this,"rotationConfig",{}),o(this,"positionComponents",{}),o(this,"intervals",{}),a(this,Un,i)}return n(t,[{key:"init",value:function(){var e=this;s(this,Un).on(m.VISIBILITY,(function(t){return e._onPageVisibilityChange(t)}),this),s(this,Un).on(m.FOCUS,(function(t){return e._onPageVisibilityChange(t)}),this)}},{key:"applyGlobalRotationConfig",value:function(e){this.rotationConfig=e}},{key:"register",value:function(e){var t=e.config.client.rotation,i=e.name;if(this.isPositionRegistered(i))Fn("Registering position ".concat(i,", but it is already registered."));else if(t.enabled){var n=!1,o=null;e.render&&e.render.completedPositionNames.includes(i)&&(n=!0,o=e.render.endTime),this.schedulerRegistry[i]={name:i,rotationCount:0,renderDone:n,viewStartTimestamp:o,rotationConfig:Ee.clone(t)},this.startScheduling(i),e.on(ot.ROTATION_UPDATE,this._onPositionRotationConfigUpdate,this)}else Fn("Position ".concat(i," has rotation disabled."))}},{key:"deregister",value:function(e){var t=e.name,i=this.schedulerRegistry[t];i?i.rotationConfig.cancellable?(this.stopScheduling(t),e.off(ot.ROTATION_UPDATE,this._onPositionRotationConfigUpdate,this),delete this.schedulerRegistry[t]):Fn("Position ".concat(t," is not cancellable.")):Fn("De-registering position ".concat(t,", but it has not been registered."))}},{key:"resetRegistration",value:function(e){var t=e.name;this.schedulerRegistry[t].rotationCount=0,e.resetRotation(),this.startScheduling(t)}},{key:"isPositionRegistered",value:function(e){return!!this.schedulerRegistry[e]}},{key:"subscribe",value:function(e){var t=e.position.name;this.isPositionRegistered(t)?this.positionComponents[t]?Fn("Subscribing to an already subscribed PositionComponent for position ".concat(t,".")):(this.positionComponents[t]=e,this._togglePositionObservers(e,!0)):Fn("Subscribing to PositionComponent for a non-registered position ".concat(t,"."))}},{key:"unsubscribe",value:function(e){var t=e.position.name;this.isPositionRegistered(t)?this.positionComponents[t]?(this._togglePositionObservers(e,!1),delete this.positionComponents[t]):Fn("Unsubscribing from a non-subscribed PositionComponent for position ".concat(t,".")):Fn("Unsubscribing from PositionComponent for a non-registered position ".concat(t,"."))}},{key:"startScheduling",value:function(e){var t=this.schedulerRegistry[e];if(t.rotationCount>=t.rotationConfig.limit)Fn("Scheduling position ".concat(e,", which has exceeded the rotation limit."));else{var i=t.rotationConfig.period;this._scheduleInterval(i);var n=this.intervals[i];n.positionNames.includes(e)||n.positionNames.push(e)}}},{key:"stopScheduling",value:function(e){var t=this.schedulerRegistry[e].rotationConfig.period,i=this.intervals[t];i?(ge.remove(i.positionNames,e),i.positionNames.length<=0&&(clearTimeout(i.timeout),delete this.intervals[t])):Fn("Removing position ".concat(e," from schedule, but it is not scheduled."))}},{key:"_onPositionRotationConfigUpdate",value:function(e){var t=e.target,i=t.name,n=this.schedulerRegistry[i],o=t.config.client.rotation,r=n.rotationConfig.period!==o.period;if(r&&this.stopScheduling(i),n.rotationConfig=Ee.clone(o),o.enabled)r&&this.startScheduling(i);else{var s=this.positionComponents[i];s&&this.unsubscribe(s),this.deregister(t)}}},{key:"_scheduleInterval",value:function(e){var t=this,i=this.intervals[e]=this.intervals[e]||{positionNames:[],timeout:null};i.timeout||(jn("Scheduling rotation interval in",e),i.timeout=setTimeout((function(){i.timeout=null,t._intervalElapsed(e)}),e))}},{key:"_intervalElapsed",value:function(e){var t=this;jn("Interval elapsed",e);var i=(new Date).getTime(),n=this.intervals[e],o=n.positionNames.filter((function(e){return t._isPositionEligibleForRotation(e,i)}));o.length>0&&this._startRotation(o),jn("Scheduled positions",n.positionNames),n.positionNames.length>0&&this._scheduleInterval(e)}},{key:"_isPositionEligibleForRotation",value:function(e,t){var i=this.schedulerRegistry[e],n=i.rotationConfig,o=i.viewStartTimestamp,r=i.renderDone,a=this.positionComponents[e];if(!r)return jn(e,"RenderNotComplete"),!1;if(!s(this,Un).isVisible)return i.waitingToBeInView=!0,jn(e,"PageHidden"),!1;if(!s(this,Un).hasFocus)return i.waitingToBeInView=!0,jn(e,"PageNotFocused"),!1;if(a.hasMouseOver)return jn(e,"MouseOver"),!1;if(a.isExpanded)return jn(e,"Expanded"),!1;if(a.adClosed)return jn(e,"AdClosed"),!1;if(n.requireViewable){if(!o)return jn(e,"NotInView"),!1;var c=t-o;if(c<n.inViewDuration&&!i.waitingToBeInView)return jn(e,"in view only for",c,"since",o),!1}return!0}},{key:"_startRotation",value:function(e){var t=this,i=this._addRotationGroupComplements(e);i.forEach((function(e){var i=t.schedulerRegistry[e];i.rotationCount++,i.renderDone=!1,i.waitingToBeInView=!1,i.rotationCount>=i.rotationConfig.limit&&t.stopScheduling(e)})),jn("Rotating",i),this.trigger(new Ln(Ln.ROTATION,{positionNames:i}))}},{key:"_addRotationGroupComplements",value:function(e){var t=[];return(this.rotationConfig&&this.rotationConfig.groups||[]).forEach((function(i){i.forEach((function(n,o){ge.isSubset(n,e)&&n.length>0&&(jn("Whole group set to be rotated",n),i.forEach((function(e,i){i!==o&&(t=t.concat(e))})))}))})),ge.removeDuplicates(e.concat(t))}},{key:"_onPageVisibilityChange",value:function(){var e=this;this._isPageActive()&&setTimeout((function(){var t=Object.keys(e.schedulerRegistry).filter((function(t){return e.schedulerRegistry[t].waitingToBeInView&&e._isPositionEligibleForRotation(t)}));t.length>0&&e._startRotation(t)}))}},{key:"_isPageActive",value:function(){return s(this,Un).isVisible&&s(this,Un).hasFocus}},{key:"_onPositionRenderStart",value:function(e){var t=e.meta.positionName;this.startScheduling(t)}},{key:"_onPositionRenderDone",value:function(e){var t=this._getRegistryItemByPositionComponentEvent(e);t.renderDone=!0,e.target.isInView&&(t.viewStartTimestamp=(new Date).getTime())}},{key:"_onNoAdForPosition",value:function(e){var t=e.meta.positionName,i=this.positionComponents[t];i&&(i.position.config.client.rotation.onNoAd?this._onPositionRenderDone(e):this.stopScheduling(t))}},{key:"_onPositionViewStart",value:function(e){this._getRegistryItemByPositionComponentEvent(e).viewStartTimestamp=(new Date).getTime()}},{key:"_onPositionViewEnd",value:function(e){this._getRegistryItemByPositionComponentEvent(e).viewStartTimestamp=null}},{key:"_getRegistryItemByPositionComponentEvent",value:function(e){var t=e.meta.positionName;return this.schedulerRegistry[t]}},{key:"_togglePositionObservers",value:function(e,t){var i=this,n=t?"on":"off",o={RENDER_START:this._onPositionRenderStart,RENDER_COMPLETE:this._onPositionRenderDone,RENDER_FAILED:this._onPositionRenderDone,NO_AD:this._onNoAdForPosition,VIEW_START:this._onPositionViewStart,VIEW_END:this._onPositionViewEnd};Object.keys(o).forEach((function(t){var r=ui[t],s=o[t];e[n](r,s,i)}))}}]),t}();Object.assign(Gn.prototype,k);var zn=Gn,Wn=n((function t(){e(this,t),o(this,"apiStatus",Ke),o(this,"usPrivacy","")})),Vn=n((function t(){e(this,t),o(this,"apiStatus",Ke),o(this,"applies",null),o(this,"euconsent","")}));function Bn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}var Hn="UserRegulation",Zn=function(t){u(o,t);var i=Bn(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(p);function Jn(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}o(Zn,"API_NOT_FOUND","".concat(Hn,".API_NOT_FOUND")),o(Zn,"READ_TIMEOUT","".concat(Hn,".READ_TIMEOUT")),o(Zn,"RESOLVED","".concat(Hn,".RESOLVED")),o(Zn,"UPDATED","".concat(Hn,".UPDATED"));var Yn,qn="GDPR",Xn="CCPA",Kn=new WeakMap,$n=new WeakMap,Qn=new WeakMap,eo=new WeakMap,to=new WeakMap,io=function(){function t(){e(this,t),Jn(this,Kn,{writable:!0,value:0}),Jn(this,$n,{writable:!0,value:void 0}),Jn(this,Qn,{writable:!0,value:!1}),Jn(this,eo,{writable:!0,value:{}}),Jn(this,to,{writable:!0,value:void 0}),a(this,$n,{CCPA:new Wn,GDPR:new Vn})}return n(t,[{key:"data",get:function(){return s(this,$n)}},{key:"resolved",get:function(){return null===s(this,Kn)}},{key:"resolve",value:function(e,t){if(t)return a(this,Kn,null),this._setDataFromConfig(t),void a(this,Qn,!0);if(!s(this,Qn)){if(a(this,Qn,!0),a(this,to,e),"function"!=typeof s(this,to).__uspapi&&"function"!=typeof s(this,to).__tcfapi)return s(this,$n).GDPR.apiStatus=s(this,$n).CCPA.apiStatus=$e,a(this,Kn,null),void this.trigger(new Zn(Zn.API_NOT_FOUND));this._readRegulatoryData()}}},{key:"_dispatchRegulationsResolvedEvent",value:function(){this.trigger(new Zn(Zn.RESOLVED))}},{key:"_dispatchRegulationsUpdatedEvent",value:function(){this.trigger(new Zn(Zn.UPDATED))}},{key:"_regulationResolved",value:function(e){s(this,eo)[e]&&delete s(this,eo)[e],0===Object.keys(s(this,eo)).length&&(null===s(this,Kn)?this._dispatchRegulationsUpdatedEvent():(clearTimeout(s(this,Kn)),a(this,Kn,null),this._dispatchRegulationsResolvedEvent()))}},{key:"_setDataFromConfig",value:function(e){e.gdpr&&(e.gdpr.euconsent?(s(this,$n).GDPR.applies=1,s(this,$n).GDPR.euconsent=""+e.gdpr.euconsent):s(this,$n).GDPR.applies=["","0","false",!1,0,void 0,null].includes(e.gdpr.applies)?0:1,s(this,$n).GDPR.apiStatus=Qe),e.ccpa&&e.ccpa.usPrivacy&&(s(this,$n).CCPA.usPrivacy=""+e.ccpa.usPrivacy,s(this,$n).CCPA.apiStatus=Qe),this._dispatchRegulationsResolvedEvent()}},{key:"_readCCPAData",value:function(){var e=this;s(this,to).__uspapi("getUSPData",1,(function(t,i){s(e,$n).CCPA.apiStatus=i?et:qe,i&&(s(e,$n).CCPA.usPrivacy=t.uspString||"",e._regulationResolved(Xn))}))}},{key:"_readTCFv2Data",value:function(){var e=this;s(this,to).__tcfapi("addEventListener",2,(function(t,i){"tcloaded"!==t.eventStatus&&"useractioncomplete"!==t.eventStatus||(s(e,$n).GDPR.apiStatus=i?et:qe,i&&(s(e,$n).GDPR.applies=!1===t.gdprApplies?0:1,s(e,$n).GDPR.euconsent=t.tcString||"",e._regulationResolved(qn)))}))}},{key:"_readRegulatoryData",value:function(){var e=this;a(this,Kn,setTimeout((function(){var t=Object.keys(s(e,eo));t.length>0?(t.forEach((function(t){s(e,$n)[t].apiStatus!==qe&&(s(e,$n)[t].apiStatus=Xe)})),e.trigger(new Zn(Zn.READ_TIMEOUT,{}))):e._dispatchRegulationsResolvedEvent(),a(e,Kn,null)}),500)),"function"==typeof s(this,to).__uspapi?s(this,eo)[Xn]="_readCCPAData":s(this,$n).CCPA.apiStatus=$e,"function"==typeof s(this,to).__tcfapi?s(this,eo)[qn]="_readTCFv2Data":s(this,$n).GDPR.apiStatus=$e,Object.keys(s(this,eo)).forEach((function(t){var i=s(e,eo)[t];e[i]()}))}}],[{key:"getInstance",value:function(){return Yn=Yn||new t}},{key:"reset",value:function(){Yn=null}}]),t}();Object.assign(io.prototype,k);var no=io,oo=function(e,t){if("string"==typeof e&&e)if(window.crypto&&crypto.subtle&&crypto.subtle.digest){var i=new TextEncoder("utf-8").encode(e.trim().toLowerCase());crypto.subtle.digest("SHA-256",i).then((function(e){var i=Array.from(new Uint8Array(e));t(i.map((function(e){return("00"+e.toString(16)).slice(-2)})).join(""))}))}else t("");else t("")};function ro(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function so(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ro(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ro(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ao="yahoo-connectid",co=function(){var e={};try{e=JSON.parse(localStorage.getItem(ao))||{}}catch(e){}return e},uo=function(e){try{localStorage.setItem(ao,JSON.stringify(e))}catch(e){}},lo=function(e){return so({},co()[e]||{})},ho=function(e,t){var i=so(so({},co()),{},o({},e,t));uo(i)},fo=function(){return co().mostRecentHashedEmail},po=function(e){var t=so(so({},co()),{},{mostRecentHashedEmail:e});uo(t)},vo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=new XMLHttpRequest,o=Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&");n.onreadystatechange=function(e){if(n.readyState===XMLHttpRequest.DONE)if(0===n.status||n.status>=200&&n.status<400)try{i(JSON.parse(n.responseText))}catch(e){i()}else i()};try{n.withCredentials=!0,n.open("GET","".concat(e,"?").concat(o),!0),n.send(t)}catch(e){}};function mo(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function go(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?mo(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):mo(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Eo={};Eo.syncHashedEmail=function(e){var t=e.pixelId,i=e.hashedEmail,n=e.gdpr,o=e.gdprConsent,r=e.usPrivacy,s=e.yahoo1p;if(t&&i){var a,c=lo(i);if(c.connectid)if(!!(a=c.connectid.lastUpdated)&&(new Date-new Date(a))/36e5<360)return;var u="https://ups.analytics.yahoo.com/ups/".concat(t,"/fed"),l=go(go(go(go({he:i},void 0!==n?{gdpr:n}:{}),void 0!==o?{gdpr_consent:o}:{}),void 0!==r?{us_privacy:r}:{}),void 0!==s?{"1p":s}:{});vo(u,l,(function(e){e&&ho(i,go(go({},c),{},{connectid:{value:e.connectid,lastUpdated:(new Date).toISOString()}}))}))}},Eo.syncIds=function(e){e.hashedEmail&&Eo.syncHashedEmail(e)};var yo=Eo;function _o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function wo(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_o(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Oo=function(e,t){var i=e.pixelId,n=e.email,o=e.gdpr,r=e.gdprConsent,s=e.usPrivacy,a=e.yahoo1p,c=n||fo();i&&c?function(e,t){e.indexOf("@")<0?t(e):oo(e,t)}(c,(function(e){po(e),yo.syncIds(wo(wo(wo(wo(wo({pixelId:i},e?{hashedEmail:e}:{}),void 0!==o?{gdpr:o}:{}),void 0!==r?{gdprConsent:r}:{}),void 0!==s?{usPrivacy:s}:{}),void 0!==a?{yahoo1p:a}:{}));var n=lo(e),c=n.connectid?n.connectid.value:void 0;t(c?{connectid:c}:{})})):t({})},bo=Oo;function Ao(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}"undefined"!=typeof exports&&(exports.getIds=Oo);var To=function(t){u(o,t);var i=Ao(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(p);function Ro(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}o(To,"TIMEOUT","TIMEOUT"),o(To,"RESOLVED","RESOLVED"),o(To,"UPDATED","UPDATED");var So=new WeakMap,Po=new WeakMap,Co=new WeakMap,Do=function(){function t(){e(this,t),Ro(this,So,{writable:!0,value:!1}),Ro(this,Po,{writable:!0,value:void 0}),Ro(this,Co,{writable:!0,value:{}})}return n(t,[{key:"resolve",value:function(e){var t=this,i=e.client.idProviders.yahoo;if(i){if(!s(this,So)){a(this,So,!0);var n={yahoo1p:1,pixelId:i.pixelId,email:i.email},o=e.service.user.regs.gdpr;null!==o.applies&&(n.gdpr=!!o.applies,n.gdprConsent=o.euconsent);var r=e.service.user.regs.ccpa;n.usPrivacy=r.usPrivacy,a(this,Po,setTimeout((function(){a(t,Po,null),t.trigger(new To(To.TIMEOUT))}),500)),bo(n,(function(e){clearTimeout(s(t,Po)),a(t,Po,null);var i=s(t,Co).CONNECTID,n=e.connectid;i&&i!==n?(s(t,Co).CONNECTID=n,t.trigger(new To(To.UPDATED))):(s(t,Co).CONNECTID=n,t.trigger(new To(To.RESOLVED)))}))}}else a(this,Po,null)}},{key:"resolved",get:function(){return null===s(this,Po)}},{key:"ids",get:function(){return s(this,Co)}}]),t}();Object.assign(Do.prototype,k);var ko=Do,Io="jac.inspect",No="".concat(Io,".position"),Lo=n((function t(){e(this,t)}));function Mo(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}o(Lo,"PAGE_LOAD","".concat(Io,".page.pageLoad")),o(Lo,"PING","".concat(Io,".handshake.ping")),o(Lo,"PONG","".concat(Io,".handshake.pong")),o(Lo,"POSITION_ADD","".concat(No,".add")),o(Lo,"FETCH_BEGIN","".concat(No,".fetchBegin")),o(Lo,"FETCH_COMPLETE","".concat(No,".fetchComplete")),o(Lo,"FETCH_TIMEOUT","".concat(No,".fetchTimeout")),o(Lo,"POSITION_ROTATE","".concat(No,".rotate")),o(Lo,"POSITION_REMOVE","".concat(No,".remove")),o(Lo,"POSITION_IN_VIEW","".concat(No,".inView")),o(Lo,"POSITION_OUT_VIEW","".concat(No,".outView")),o(Lo,"POSITION_RENDER_START","".concat(No,".renderStart")),o(Lo,"POSITION_RENDER_COMPLETE","".concat(No,".renderComplete")),o(Lo,"POSITION_COLLAPSED","".concat(No,".collapsed")),o(Lo,"AD_LOAD_COMPLETE","".concat(No,".ad.loadComplete")),o(Lo,"AD_SIZE_CHANGED","".concat(No,".ad.sizeChanged")),o(Lo,"POSITION_CONFIG_CHANGED","".concat(No,".configChanged")),o(Lo,"POSITION_AD_MARKUP_REQUESTED","".concat(No,".ad.markupRequested")),o(Lo,"POSITION_AD_MARKUP","".concat(No,".ad.markup"));var xo=/\d\.\d\.\d(-rc\.\d{1,})?\/jac\.js$/,Fo=new WeakMap,jo=new WeakMap,Uo=new WeakMap,Go=new WeakMap,zo=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;if(e(this,t),Mo(this,Fo,{writable:!0,value:void 0}),Mo(this,jo,{writable:!0,value:void 0}),o(this,"networkType",void 0),Mo(this,Uo,{writable:!0,value:!0}),Mo(this,Go,{writable:!0,value:void 0}),!i.performance)return Ne.warning("No performance support available"),void a(this,Uo,!1);a(this,Go,i);var n=i.navigator,r=n.connection||n.mozConnection||n.webkitConnection;this.networkType=r?r.effectiveType:"unknown";var c=i.performance;if(a(this,Fo,parseFloat(c.timing.navigationStart.toFixed(2))),a(this,jo,parseFloat(c.timing.responseEnd.toFixed(2))),c.getEntriesByType){var u=c.getEntriesByType("navigation");u&&u[0]&&a(this,jo,parseFloat((u[0].responseEnd+s(this,Fo)).toFixed(2)))}}return n(t,[{key:"getClientResourceTiming",value:function(){if(s(this,Uo)&&s(this,Go).performance.getEntriesByType){var e=s(this,Go).performance.getEntriesByType("resource").filter((function(e){return e.name.match(xo)}));return e.length>0?e[0]:void 0}}},{key:"getFetchResourceTiming",value:function(e){if(s(this,Uo)&&e&&S.isString(e)&&!(e.length<20)&&s(this,Go).performance.getEntriesByType){var t=s(this,Go).performance.getEntriesByType("resource").filter((function(t){return"script"===t.initiatorType&&t.name===e}));return t.length>0?t[t.length-1]:void 0}}},{key:"responseEnd",get:function(){return s(this,jo)}},{key:"timeOrigin",get:function(){return s(this,Fo)}}]),t}();function Wo(e){var t=[],i=e;try{for(;i;)(i=i.getRootNode())&&Node.DOCUMENT_FRAGMENT_NODE===i.nodeType?(i=i.host)&&t.push(i.id||""):i=i.parentNode}catch(e){Ne.error("Error occured while parsing the DOM hierarchy",e)}return t}function Vo(e){var t,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,o=[],r=Ee.clone(e);return S.isString(r.client.targetElement)?(t=r.client.targetElement,i=n.getElementById(t)):S.isDOMNode(r.client.targetElement)&&(o=Wo(e.client.targetElement),i=r.client.targetElement,r.client.targetElement=r.client.targetElement.toString(),r.input.client.targetElement=r.input.client.targetElement.toString(),t=i.id),{positionConfig:r,element:i,elementId:t,domContextIds:o}}var Bo=function(){function t(){e(this,t)}return n(t,null,[{key:"createPongEvent",value:function(e,t,i){var n=(i=i||new zo).getClientResourceTiming(),o=e._config.service.site,r={topic:Lo.PONG,meta:{timestamp:(new Date).getTime(),responseEnd:i.responseEnd,history:t,client:{version:e.version},adServer:{meta:{},params:{}},site:{spaceId:o.spaceId,name:o.name,category:o.category}}};n&&(r.meta.client.loadTime=n.responseEnd,r.meta.client.loadComplete=n.responseEnd+i.timeOrigin,r.meta.client.url=n.name);var s=e._config.service.adServer;return Object.keys(s).filter((function(e,t){return 0===t})).forEach((function(e){var t=s[e];r.meta.adServer.name=e,r.meta.adServer.params=t.params,e!==ze.RAS&&e!==ze["1AS"]||(r.meta.adServer.meta.region=t.region,r.meta.adServer.revshare=t.revshare||"",r.meta.adServer.lmsid=t.lmsid||"")})),r}},{key:"createPositionAddEvent",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,n=e._positions[t],o=Vo(n.config,i),r=o.positionConfig,s=o.elementId,a=o.element,c=o.domContextIds,u=a?a.getBoundingClientRect().top:null,l={topic:Lo.POSITION_ADD,meta:{timestamp:(new Date).getTime(),config:r,name:t,domContextIds:c,elementId:s,elementTop:u,sizes:n.config.service.sizes,containerType:n.containerType,params:n.config.service.params}};return l}},{key:"createFetchBeginEvent",value:function(e,t,i,n){return{topic:Lo.FETCH_BEGIN,meta:{timestamp:n,name:e,url:t,prefetched:!!i}}}},{key:"createFetchTimeoutEvent",value:function(e,t){return{topic:Lo.FETCH_TIMEOUT,meta:{timestamp:(new Date).getTime(),name:e,url:t}}}},{key:"createFetchCompleteEvent",value:function(e){var t=e.jac,i=e.positionName,n=e.url,o=e.jillTimings,r=e.positionResponse,s=e.requestTimings,a=t._positions[i],c={meta:r.meta},u=r.content.crId,l=(a?a.config.service.alias:void 0)||r.alias;return{topic:Lo.FETCH_COMPLETE,meta:{timestamp:(new Date).getTime(),name:i,url:n,upstreamResponseDuration:o.upstreamDuration,serviceResponseDuration:o.totalRequestDuration,totalServiceResponseDuration:s?s.duration:null,processingDuration:o.processingDuration,alias:l,creativeId:u,adData:c,status:r.status}}}},{key:"createPositionRotateEvent",value:function(e){return{topic:Lo.POSITION_ROTATE,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionRemoveEvent",value:function(e){return{topic:Lo.POSITION_REMOVE,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionInViewEvent",value:function(e){return{topic:Lo.POSITION_IN_VIEW,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionOutOfViewEvent",value:function(e){return{topic:Lo.POSITION_OUT_VIEW,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionRenderStartEvent",value:function(e,t){var i=e._positions[t];return{topic:Lo.POSITION_RENDER_START,meta:{timestamp:(new Date).getTime(),name:t,timeout:i.config.client.render.timeout}}}},{key:"createPositionRenderCompleteEvent",value:function(e,t,i,n){var o=e._positions[t],r={topic:Lo.POSITION_RENDER_COMPLETE,meta:{timestamp:(new Date).getTime(),name:t,containerType:o.containerType}};return void 0!==l(i)&&void 0!==l(n)&&(r.meta.size=i+"x"+n),r}},{key:"createAdSizeChangedEvent",value:function(e,t,i){var n={topic:Lo.AD_SIZE_CHANGED,meta:{timestamp:(new Date).getTime(),name:e}};return void 0!==l(t)&&void 0!==l(i)&&(n.meta.size=t+"x"+i),n}},{key:"createAdLoadCompleteEvent",value:function(e){return{topic:Lo.AD_LOAD_COMPLETE,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPageLoadEvent",value:function(e){return{topic:Lo.PAGE_LOAD,meta:{timestamp:e}}}},{key:"createPositionCollapsedEvent",value:function(e){return{topic:Lo.POSITION_COLLAPSED,meta:{timestamp:(new Date).getTime(),name:e}}}},{key:"createPositionConfigChangedEvent",value:function(e,t){return{topic:Lo.POSITION_CONFIG_CHANGED,meta:{timestamp:(new Date).getTime(),name:e,config:Vo(t).positionConfig}}}},{key:"createPositionAdMarkupEvent",value:function(e,t){return{topic:Lo.POSITION_AD_MARKUP,meta:{timestamp:(new Date).getTime(),name:e,markup:t}}}}]),t}();function Ho(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Zo(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}var Jo=new WeakMap,Yo=new WeakMap,qo=new WeakMap,Xo=new WeakMap,Ko=function(){function t(){e(this,t),Zo(this,Jo,{writable:!0,value:void 0}),Zo(this,Yo,{writable:!0,value:void 0}),Zo(this,qo,{writable:!0,value:[]}),Zo(this,Xo,{writable:!0,value:{}})}return n(t,[{key:"history",get:function(){return s(this,qo)}},{key:"activate",value:function(e,t){var i=this;a(this,Yo,t);var n=De.getParameter(e.location.href,"jac.inspect");if("1"===n)this._launchInspector();else if("2"===n){this._launchInspector("?jac.newWindow=true")}this.on(Lo.PING,this._onPing,this),this.on(Lo.POSITION_AD_MARKUP_REQUESTED,this._onMarkupRequested,this),this._initInternalListeners(t),e.addEventListener("message",(function(e){var t=e.data.topic;t!==Lo.PING&&t!==Lo.POSITION_AD_MARKUP_REQUESTED||i.trigger(new p(t,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ho(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ho(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({source:e.source},e.data.meta)))}))}},{key:"produceEvent",value:function(e){s(this,Jo)?s(this,Jo).postMessage(e,"*"):s(this,qo).push(e)}},{key:"_launchInspector",value:function(e){e=e||"";var t=document.createElement("script");t.src="https://s.yimg.com/ap/jacky/bootstrap/jacky-bootstrap.min.js"+e,document.head.appendChild(t)}},{key:"_initInternalListeners",value:function(e){e.on(St.POSITION_CREATED,this._onPositionCreated,this),e._jill.on(zt.FETCH_START,this._onFetchStart,this),e._jill.on(zt.RESPONSE_PROCESSED,this._onJillResponseProcessed,this),e._jill.on(zt.FETCH_TIMEOUT,this._onJillFetchTimeout,this),e.on(St.POSITION_ROTATE,this._onPositionRotate,this),e.on(St.POSITION_VIEW_START,this._onPositionViewStart,this),e.on(St.POSITION_VIEW_END,this._onPositionViewEnd,this),e.on(St.POSITION_RENDER_START,this._onPositionRenderStart,this),e.on(St.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),e.on(St.POSITION_COLLAPSED,this._onPositionCollapsed,this),e.on(St.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),e.on(St.AD_SIZE_CHANGED,this._onAdSizeChanged,this),e._pageObserver.on(m.LOADED,this._onPageLoad,this),e.on(St.POSITION_CONFIG_CHANGED,this._onPositionConfigChanged,this)}},{key:"_onPing",value:function(e){var t=s(this,Yo)._config;t&&t.service?s(this,Jo)?Ne.warning("Already responded to the ping request."):(a(this,Jo,e.meta.source),this._sendPong()):Ne.warning("No config set yet. Can not reply to inspect ping requests.")}},{key:"_onMarkupRequested",value:function(e){e.meta&&e.meta.name?s(this,Jo)?s(this,Xo)[e.meta.name]&&this.produceEvent(Bo.createPositionAdMarkupEvent(e.meta.name,s(this,Xo)[e.meta.name])):Ne.warning("No ping initialization request got."):Ne.warning("No position name provided in the ad markup request.")}},{key:"_sendPong",value:function(){var e=Bo.createPongEvent(s(this,Yo),s(this,qo));this.produceEvent(e),a(this,qo,[])}},{key:"_onPositionCreated",value:function(e){this.produceEvent(Bo.createPositionAddEvent(s(this,Yo),e.meta.positionName))}},{key:"_onFetchStart",value:function(e){var t=this,i=e.meta.url,n=e.meta.prefetched,o=(new Date).getTime();Object.keys(e.meta.request.positions).forEach((function(e){t.produceEvent(Bo.createFetchBeginEvent(e,i,n,o))}))}},{key:"_onJillFetchTimeout",value:function(e){var t=this,i=e.meta.url;e.meta.positionNames.forEach((function(e){t.produceEvent(Bo.createFetchTimeoutEvent(e,i))}))}},{key:"_onJillResponseProcessed",value:function(e){var t=this,i=e.meta.url,n=e.meta.response,o=n.positions,r=n.service.timings||{};n.adServer&&(r.upstreamDuration=n.adServer.requestDuration);var a=s(this,Yo),c=(new zo).getFetchResourceTiming(i);Object.keys(o).forEach((function(e){s(t,Xo)[e]=o[e][0].content.markup,t.produceEvent(Bo.createFetchCompleteEvent({jac:a,positionName:e,url:i,jillTimings:r,positionResponse:o[e][0],requestTimings:c}))}))}},{key:"_onPositionRotate",value:function(e){this.produceEvent(Bo.createPositionRotateEvent(e.meta.positionName))}},{key:"_onPositionViewStart",value:function(e){this.produceEvent(Bo.createPositionInViewEvent(e.meta.positionName))}},{key:"_onPositionViewEnd",value:function(e){this.produceEvent(Bo.createPositionOutOfViewEvent(e.meta.positionName))}},{key:"_onPositionRenderStart",value:function(e){this.produceEvent(Bo.createPositionRenderStartEvent(s(this,Yo),e.meta.positionName))}},{key:"_onPositionRenderComplete",value:function(e){this.produceEvent(Bo.createPositionRenderCompleteEvent(s(this,Yo),e.meta.positionName,e.meta.width,e.meta.height))}},{key:"_onAdLoadComplete",value:function(e){this.produceEvent(Bo.createAdLoadCompleteEvent(e.meta.positionName))}},{key:"_onAdSizeChanged",value:function(e){this.produceEvent(Bo.createAdSizeChangedEvent(e.meta.positionName,e.meta.width,e.meta.height))}},{key:"_onPageLoad",value:function(e){this.produceEvent(Bo.createPageLoadEvent(e.meta.timestamp))}},{key:"_onPositionCollapsed",value:function(e){this.produceEvent(Bo.createPositionCollapsedEvent(e.meta.positionName))}},{key:"_onPositionConfigChanged",value:function(e){this.produceEvent(Bo.createPositionConfigChangedEvent(e.meta.positionName,e.meta.config))}},{key:"adHistory",get:function(){return s(this,Xo)}}]),t}();Object.assign(Ko.prototype,k);var $o=Ko;function Qo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}var er="Collector",tr=function(t){u(o,t);var i=Qo(o);function o(t,n){var r;return e(this,o),(r=i.call(this,t)).meta=n,r}return n(o)}(p);function ir(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}o(tr,"COUNTER","".concat(er,".COUNTER")),o(tr,"DURATION","".concat(er,".DURATION"));var nr={JacLoadDelay:"JacLoadDelay",FetchDelay:"FetchDelay",FetchTimeoutCount:"FetchTimeoutCount",FetchNetworkDuration:"FetchNetworkDuration",PositionFetchDuration:"PositionFetchDuration",PositionRenderDelay:"PositionRenderDelay",PositionRenderDuration:"PositionRenderDuration",PositionViewableDelay:"PositionViewableDelay",AdLoadDuration:"AdLoadDuration",PositionFetchErrorCount:"PositionFetchErrorCount",PositionAdClosedCount:"PositionAdClosedCount",PositionAdOpenedCount:"PositionAdOpenedCount"},or=[nr.FetchTimeoutCount];function rr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?"".concat(e,"_").concat(JSON.stringify(t)):e}function sr(e){return e.split("_")[0]}var ar=new WeakMap,cr=new WeakMap,ur=new WeakMap,lr=new WeakMap,hr=new WeakMap,dr=new WeakMap,fr=new WeakMap,pr=new WeakMap,vr=new WeakMap,mr=new WeakMap,gr=new WeakMap,Er=new WeakMap,yr=function(){function t(i,n){e(this,t),ir(this,ar,{writable:!0,value:void 0}),ir(this,cr,{writable:!0,value:void 0}),ir(this,ur,{writable:!0,value:{}}),ir(this,lr,{writable:!0,value:{}}),ir(this,hr,{writable:!0,value:{}}),ir(this,dr,{writable:!0,value:{}}),ir(this,fr,{writable:!0,value:{}}),ir(this,pr,{writable:!0,value:void 0}),ir(this,vr,{writable:!0,value:void 0}),ir(this,mr,{writable:!0,value:void 0}),ir(this,gr,{writable:!0,value:void 0}),ir(this,Er,{writable:!0,value:void 0}),a(this,ar,i),a(this,cr,n||new zo),a(this,pr,s(this,cr).networkType),a(this,vr,s(this,cr).responseEnd),a(this,gr,nr),a(this,Er,!0)}return n(t,[{key:"start",value:function(){this._toggleEventListeners(!0);var e={networkType:s(this,pr)};this.markDurationStart(nr.JacLoadDelay,e,s(this,vr)),a(this,mr,(new Date).getTime()),this.markDurationEnd(nr.JacLoadDelay,e,s(this,mr))}},{key:"stop",value:function(){this._toggleEventListeners(!1)}},{key:"setActiveMetrics",value:function(e){var t=this;a(this,gr,{}),e.forEach((function(e){return s(t,gr)[e]=nr[e]}));var i=s(this,ar);s(this,gr)[nr.FetchDelay]||s(this,gr)[nr.PositionFetchDuration]||i._jill.off(zt.FETCH_START,this._onFetchStart,this),s(this,gr)[nr.FetchNetworkDuration]||i._jill.off(zt.FETCH_COMPLETE,this._onJillFetchComplete,this),s(this,gr)[nr.PositionFetchDuration]||s(this,gr)[nr.PositionRenderDelay]||i.off(St.FETCH_COMPLETE,this._onFetchComplete,this),s(this,gr)[nr.FetchTimeoutCount]||i.off(St.FETCH_TIMEOUT,this._onFetchTimeout,this),s(this,gr)[nr.PositionRenderDelay]||s(this,gr)[nr.PositionRenderDuration]||i.off(St.POSITION_RENDER_START,this._onPositionRenderStart,this),s(this,gr)[nr.PositionRenderDuration]||s(this,gr)[nr.PositionViewableDelay]||s(this,gr)[nr.AdLoadDuration]||i.off(St.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),s(this,gr)[nr.PositionViewableDelay]||i.off(St.POSITION_VIEWABLE,this._onPositionViewable,this),s(this,gr)[nr.AdLoadDuration]||i.off(St.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),s(this,gr)[nr.PositionFetchErrorCount]||i.off(St.FETCH_ERROR,this._onFetchError,this),s(this,gr)[nr.PositionAdClosedCount]||i.off(St.AD_CLOSED,this._onAdClosed,this),s(this,gr)[nr.PositionAdOpenedCount]||i.off(St.AD_OPENED,this._onAdOpened,this),this._cleanNonActiveCollectedMetrics()}},{key:"_cleanNonActiveCollectedMetrics",value:function(){var e=this;Object.keys(s(this,lr)).forEach((function(t){var i=sr(t);s(e,gr)[i]||delete s(e,lr)[t]})),Object.keys(s(this,hr)).forEach((function(t){var i=sr(t);s(e,gr)[i]||delete s(e,hr)[t]}))}},{key:"durations",get:function(){var e=s(this,Er)?s(this,dr):s(this,lr);return Object.keys(e).reduce((function(t,i){return t.concat(e[i])}),[])}},{key:"counters",get:function(){var e=s(this,Er)?s(this,fr):s(this,hr);return Object.keys(e).map((function(t){return e[t]}))}},{key:"flush",value:function(){s(this,Er)?(a(this,dr,{}),a(this,fr,{})):(a(this,lr,{}),a(this,hr,{}))}},{key:"markDurationStart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(s(this,gr)[e]){i=i||(new Date).getTime();var n=rr(e,t);s(this,ur)[n]&&Ne.warning("".concat(n," duration metric already started.")),s(this,ur)[n]={name:e,startTime:i,dimensions:t}}}},{key:"markDurationEnd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(s(this,gr)[e]){i=i||(new Date).getTime();var n=rr(e,t);if(s(this,ur)[n]){var o=s(this,ur)[n];o.endTime=i,o.duration=parseFloat((o.endTime-o.startTime).toFixed(2));var r=or.includes(e);s(this,Er)&&r?(s(this,dr)[n]=s(this,dr)[n]||[],s(this,dr)[n].push(o)):(s(this,lr)[n]=s(this,lr)[n]||[],s(this,lr)[n].push(o)),delete s(this,ur)[n],s(this,Er)&&!r||this._notifyMetricEvent(new tr(tr.DURATION,o))}else Ne.error("".concat(n," duration metric not started."))}}},{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(s(this,gr)[e]){var i=rr(e,t),n=or.includes(e),o=s(this,Er)&&n?s(this,fr):s(this,hr),r=o[i]=o[i]||{name:e,count:0,dimensions:t};r.count++,s(this,Er)&&!n||this._notifyMetricEvent(new tr(tr.COUNTER,r))}}},{key:"disableBufferMode",value:function(){a(this,Er,!1)}},{key:"_onFetchStart",value:function(e){var t=this,i=Object.keys(e.meta.request.positions),n=s(this,pr);this.durations[nr.FetchDelay]||(this.markDurationStart(nr.FetchDelay,{networkType:n},s(this,mr)),this.markDurationEnd(nr.FetchDelay,{networkType:n})),i.forEach((function(e){t.markDurationStart(nr.PositionFetchDuration,{positionName:e,networkType:n})}))}},{key:"_onJillFetchComplete",value:function(e){var t=e.meta.url,i=s(this,cr).getFetchResourceTiming(t);if(i&&i.duration){var n=s(this,pr);this.markDurationStart(nr.FetchNetworkDuration,{networkType:n},i.startTime),this.markDurationEnd(nr.FetchNetworkDuration,{networkType:n},i.responseEnd)}}},{key:"_onFetchComplete",value:function(e){var t=this,i=e.meta.positionNames,n=s(this,pr);i.forEach((function(e){t.markDurationEnd(nr.PositionFetchDuration,{positionName:e,networkType:n}),t.markDurationStart(nr.PositionRenderDelay,{positionName:e,networkType:n})}))}},{key:"_onFetchTimeout",value:function(){this.incrementCounter(nr.FetchTimeoutCount)}},{key:"_onPositionRenderStart",value:function(e){var t=e.meta.positionName,i=s(this,pr),n=rr(nr.PositionRenderDelay,{positionName:t,networkType:i});s(this,ur)[n]&&this.markDurationEnd(nr.PositionRenderDelay,{positionName:t,networkType:i}),this.markDurationStart(nr.PositionRenderDuration,{positionName:t,networkType:i})}},{key:"_onPositionRenderComplete",value:function(e){var t=e.meta.positionName,i=s(this,pr);this.markDurationEnd(nr.PositionRenderDuration,{positionName:t,networkType:i}),this.markDurationStart(nr.AdLoadDuration,{positionName:t,networkType:i}),this.markDurationStart(nr.PositionViewableDelay,{positionName:t})}},{key:"_onPositionViewable",value:function(e){var t=e.meta.positionName;this.markDurationEnd(nr.PositionViewableDelay,{positionName:t})}},{key:"_onAdLoadComplete",value:function(e){var t=e.meta.positionName,i=s(this,pr);this.markDurationEnd(nr.AdLoadDuration,{positionName:t,networkType:i})}},{key:"_onFetchError",value:function(e){var t=this;e.meta.positionNames.forEach((function(e){t.incrementCounter(nr.PositionFetchErrorCount,{positionName:e})}))}},{key:"_onAdClosed",value:function(e){this._incrementCounterPerPosition(e,nr.PositionAdClosedCount)}},{key:"_onAdOpened",value:function(e){this._incrementCounterPerPosition(e,nr.PositionAdOpenedCount)}},{key:"_notifyMetricEvent",value:function(e){var t=this;setTimeout((function(){t.trigger(e)}),0)}},{key:"_incrementCounterPerPosition",value:function(e,t){var i=e.meta.positionName;this.incrementCounter(t,{positionName:i})}},{key:"_toggleEventListeners",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?"on":"off",i=s(this,ar);i._jill[t](zt.FETCH_START,this._onFetchStart,this),i._jill[t](zt.FETCH_COMPLETE,this._onJillFetchComplete,this),i[t](St.FETCH_COMPLETE,this._onFetchComplete,this),i[t](St.FETCH_TIMEOUT,this._onFetchTimeout,this),i[t](St.POSITION_RENDER_START,this._onPositionRenderStart,this),i[t](St.POSITION_RENDER_COMPLETE,this._onPositionRenderComplete,this),i[t](St.POSITION_VIEWABLE,this._onPositionViewable,this),i[t](St.AD_LOAD_COMPLETE,this._onAdLoadComplete,this),i[t](St.FETCH_ERROR,this._onFetchError,this),i[t](St.AD_CLOSED,this._onAdClosed,this),i[t](St.AD_OPENED,this._onAdOpened,this)}}]),t}();function _r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function wr(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_r(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Or(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}Object.assign(yr.prototype,k);var br=("undefined"==typeof $METRIC_HOST$?"undefined":l($METRIC_HOST$))!==A?$METRIC_HOST$:"https://jill.fc.yahoo.com/",Ar="v1/client/m",Tr="undefined"!=typeof $JAC_METRICS_QUEUE_DELAY$?$JAC_METRICS_QUEUE_DELAY$:5e3,Rr=new WeakMap,Sr=new WeakMap,Pr=new WeakMap,Cr=new WeakMap,Dr=new WeakMap,kr=new WeakMap,Ir=new WeakMap,Nr=function(){function t(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;e(this,t),Or(this,Rr,{writable:!0,value:void 0}),Or(this,Sr,{writable:!0,value:void 0}),Or(this,Pr,{writable:!0,value:void 0}),Or(this,Cr,{writable:!0,value:{}}),Or(this,Dr,{writable:!0,value:!1}),Or(this,kr,{writable:!0,value:void 0}),Or(this,Ir,{writable:!0,value:void 0}),a(this,Rr,i);var r,s,c=o.JAC_CONFIG||{};c.service&&c.service.site&&(r=c.service.site.name,s=c.service.site.category),this.setGlobalTags({siteName:r,siteCategory:s}),a(this,Sr,"".concat(br).concat(Ar)),a(this,Pr,n.version),a(this,Ir,o)}return n(t,[{key:"activate",value:function(){var e=this;s(this,kr)||(s(this,Rr).on(tr.COUNTER,this._enqueueReport,this),s(this,Rr).on(tr.DURATION,this._enqueueReport,this),a(this,kr,(function(){return e.report()})),s(this,Ir).addEventListener("unload",s(this,kr)))}},{key:"deactivate",value:function(){s(this,kr)&&(s(this,Rr).off(tr.COUNTER,this._enqueueReport,this),s(this,Rr).off(tr.DURATION,this._enqueueReport,this),s(this,Ir).removeEventListener("unload",s(this,kr)),a(this,kr,null))}},{key:"setGlobalTags",value:function(e){var t=e.siteName,i=e.siteCategory;a(this,Cr,wr(wr({},s(this,Cr)),{},{siteName:t,siteCategory:i}))}},{key:"report",value:function(){var e=s(this,Rr).durations.map((function(e){return{type:"duration",value:e.duration,name:e.name,tags:e.dimensions||void 0}})),t=s(this,Rr).counters.map((function(e){return{type:"count",value:e.count,name:e.name,tags:e.dimensions||void 0}})),i=e.concat(t);if(!(i.length<=0)){var n=JSON.stringify({jacVersion:s(this,Pr),tags:s(this,Cr)||void 0,metrics:i});"function"==typeof s(this,Ir).navigator.sendBeacon?s(this,Ir).navigator.sendBeacon(s(this,Sr),n):(new(s(this,Ir).Image)).src="".concat(s(this,Sr),"?data=").concat(encodeURIComponent(n)),s(this,Rr).flush()}}},{key:"_enqueueReport",value:function(){var e=this;s(this,Dr)||(a(this,Dr,!0),setTimeout((function(){e.report(),a(e,Dr,!1)}),Tr))}},{key:"jacVersion",get:function(){return s(this,Pr)}},{key:"collector",get:function(){return s(this,Rr)}},{key:"globalTags",get:function(){return s(this,Cr)}},{key:"beaconUrl",get:function(){return s(this,Sr)}}]),t}();function Lr(e,t,i){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,i)}Object.assign(Nr.prototype,k);var Mr=new WeakMap,xr=function(){function t(){e(this,t),o(this,"collector",void 0),o(this,"reporter",void 0),Lr(this,Mr,{writable:!0,value:void 0})}return n(t,[{key:"init",value:function(e){this.collector=new yr(e),this.reporter=new Nr(this.collector,e),this.reporter.activate(),this.collector.start()}},{key:"processMetricsEnableStatus",value:function(){var e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(null==i||null===(e=i.metrics)||void 0===e?void 0:e.samplingPercent)||0,o=S.getRandomInt(1,100),r=n>=o,c=(null==i||null===(t=i.metrics)||void 0===t?void 0:t.samplingRateExempt)||[];S.isSet(s(this,Mr))||(a(this,Mr,!1!==r||c.length>0),this.collector&&(this.collector.disableBufferMode(),!r&&c.length>0&&this.collector.setActiveMetrics(c),s(this,Mr)||this.collector.stop()))}},{key:"configUpdated",value:function(e){var t=e.service.site||{},i=t.name,n=t.category;this.reporter.setGlobalTags({siteName:i,siteCategory:n})}}]),t}(),Fr={ar:{closeAdLabel:" ",showAdLabel:" "},bg:{closeAdLabel:" ",showAdLabel:" "},bn:{closeAdLabel:" ",showAdLabel:" "},cs:{closeAdLabel:"Zavt reklamu",showAdLabel:"Zobrazit reklamu"},da:{closeAdLabel:"Luk annonce",showAdLabel:"Vis annonce"},de:{closeAdLabel:"Werbung schlieen",showAdLabel:"Werbung anzeigen"},el:{closeAdLabel:"",showAdLabel:""},en:{closeAdLabel:"Close ad",showAdLabel:"Show ad"},es:{closeAdLabel:"Cerrar anuncio",showAdLabel:"Mostrar anuncio"},et:{closeAdLabel:"Sule reklaam",showAdLabel:"Nita reklaami"},fi:{closeAdLabel:"Sulje mainos",showAdLabel:"Nyt mainos"},fil:{closeAdLabel:"Isara ang Ad",showAdLabel:"Ipakita ang Ad"},fr:{closeAdLabel:"Fermer l'annonce",showAdLabel:"Afficher la pub"},"fr-ca":{closeAdLabel:"Fermer la publicit",showAdLabel:"Afficher la pub"},gr:{closeAdLabel:"",showAdLabel:""},gu:{closeAdLabel:"  ",showAdLabel:" "},he:{closeAdLabel:" ",showAdLabel:" "},hi:{closeAdLabel:"  ",showAdLabel:" "},hr:{closeAdLabel:"Zatvori oglas",showAdLabel:"Pokai oglas"},hu:{closeAdLabel:"Hirdets bezrsa",showAdLabel:"Hirdets megjelentse"},id:{closeAdLabel:"Tutup Iklan",showAdLabel:"Tampilkan Iklan"},it:{closeAdLabel:"Chiudi annuncio",showAdLabel:"Mostra annuncio"},ja:{closeAdLabel:"",showAdLabel:""},kn:{closeAdLabel:" ",showAdLabel:" "},ko:{closeAdLabel:" ",showAdLabel:" "},lt:{closeAdLabel:"Udaryti reklam",showAdLabel:"Rodyti reklam"},lv:{closeAdLabel:"Aizvrt reklmu",showAdLabel:"Rdt reklmu"},ml:{closeAdLabel:" ",showAdLabel:" "},mr:{closeAdLabel:"  ",showAdLabel:" "},ms:{closeAdLabel:"Tutup ad",showAdLabel:"Tunjukkan Iklan"},nb:{closeAdLabel:"Lukk annonse",showAdLabel:"Vis annonse"},no:{closeAdLabel:"Lukk annonse",showAdLabel:"Vis annonse"},nl:{closeAdLabel:"Advertentie sluiten",showAdLabel:"Advertentie weergeven"},"nl-be":{closeAdLabel:"Advertentie sluiten",showAdLabel:"Advertentie tonen"},pl:{closeAdLabel:"Zamknij reklam",showAdLabel:"Wywietl reklam"},pt:{closeAdLabel:"Fechar anncio",showAdLabel:"Mostrar anncio"},ro:{closeAdLabel:"nchide",showAdLabel:"Deschide"},ru:{closeAdLabel:" ",showAdLabel:" "},sk:{closeAdLabel:"Zavrie reklamu",showAdLabel:"Zobrazi reklamu"},sl:{closeAdLabel:"Zapri oglas",showAdLabel:"Pokai oglas"},sr:{closeAdLabel:" ",showAdLabel:" "},sv:{closeAdLabel:"Stng",showAdLabel:"ppna"},ta:{closeAdLabel:" ",showAdLabel:" "},te:{closeAdLabel:" ",showAdLabel:" "},th:{closeAdLabel:"",showAdLabel:""},tr:{closeAdLabel:"Reklam Kapat",showAdLabel:"Reklam Gster"},tw:{closeAdLabel:"",showAdLabel:""},uk:{closeAdLabel:" ",showAdLabel:" "},ur:{closeAdLabel:"  ",showAdLabel:" "},vi:{closeAdLabel:"ng Qung co",showAdLabel:"Hin th Qung co"},zh:{closeAdLabel:"",showAdLabel:""},"zh-cn":{closeAdLabel:"",showAdLabel:""},"zh-hk":{closeAdLabel:"",showAdLabel:""},"zh-tw":{closeAdLabel:"",showAdLabel:""}},jr=function(){var e=(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage).toLowerCase();return Fr[e]||Fr.en};function Ur(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Gr(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ur(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ur(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var zr=function(e,t,i){var n=t.positions,o=jr();return e.reduce((function(e,t){var r=i.positions[t],s=n[t]?n[t][0]:null;if(!r||!s)return Ne.warning("Position ".concat(t," is not valid to be processed from the response.")),e;s.config=Ee.clone(r),s.config.client.closeButton.labels={close:o.closeAdLabel,show:o.showAdLabel};var a=r.input.client.closeButton||{};Ee.copy(r.client.closeButton.labels,s.config.client.closeButton.labels,!0),Ee.copy(a.labels||{},s.config.client.closeButton.labels);var c=r.service.sizes;if(S.isString(c)){if(!S.isObject(tt)||!tt[c])return void Ne.warning("Position ".concat(t," size mapping lookup failure."));s.config.service.sizes=tt[c]}return s.meta=s.meta||{},s.timestamp=(new Date).getTime(),s.meta.isMobileMoment=pe.isMobileMomentAd(s),e[t]=s,e}),{})},Wr=function(e,t){return e.reduce((function(e,i){var n=t.positions[i];return n?(e[i]={status:He,content:{},config:n,meta:{},timestamp:(new Date).getTime()},e):(Ne.warning("Timeout for a non-existing position ".concat(i," received.")),e)}),{})},Vr=function(e){var t=e.client.content;return t&&t.markup?(e.service.sizes=e.service.sizes||["".concat(t.size.width,"x").concat(t.size.height)],{status:Ve,content:{markup:t.markup,size:Gr(Gr({},t.size),{},{unit:We})},config:e,meta:{},timestamp:(new Date).getTime()}):null};function Br(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=t.document,n=i.createElement("iframe");n.src=e,re.setStyles(n,{display:"none",border:"none",width:0,height:0}),i.body.appendChild(n)}var Hr=function(){function t(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;e(this,t),o(this,"userRegulations",void 0),o(this,"windowContext",void 0),this.userRegulations=i,this.windowContext=n}return n(t,[{key:"injectTrackers",value:function(e){var t=this;!e||e.opus?this._onUserRegulationsResolved((function(){return t._injectOpusTag()})):e&&e.smartPixel&&this._injectSmartPixelTag(),e&&e.msftSync&&((new Image).src="https://cms.analytics.yahoo.com/cms?partner_id=MSFT")}},{key:"_onUserRegulationsResolved",value:function(e){this.userRegulations.resolved?e():(this.userRegulations.on(Zn.RESOLVED,e),this.userRegulations.on(Zn.READ_TIMEOUT,e),this.userRegulations.on(Zn.API_NOT_FOUND,e))}},{key:"_injectOpusTag",value:function(){var e=De.removeParameters(this.windowContext.document.referrer);Br("https://opus.analytics.yahoo.com/tag/opus-frame.html"+"?referrer=".concat(encodeURIComponent(e)),this.windowContext)}},{key:"_injectSmartPixelTag",value:function(){var e=De.removeParameters(this.windowContext.document.referrer);Br("".concat("https://tag.idsync.analytics.yahoo.com/sp-frame.html","?referrer=").concat(encodeURIComponent(e)),this.windowContext)}}]),t}();function Zr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h(this,i)}}var Jr=function(t){u(o,t);var i=Zr(o);function o(){return e(this,o),i.apply(this,arguments)}return n(o)}(Jt);o(Jr,"ACTION_NAME","render");var Yr=l("1.3.0")!==A?"1.3.0":"0.0.0",qr={},Xr=new oi(Yr),Kr=new U,$r=new In,Qr=new zn(Kr),es=no.getInstance(),ts=new ko,is=new $o,ns=new xr,os=new At,rs=new Hr(es);function ss(e,t,i){if(!Array.isArray(t)||0===t.length)return Ne.warning("Invalid array of position names used with JAC.".concat(e,"()")),{result:!1,validPositionNames:[]};var n=t.filter((function(e){return gs._config.positions[e]&&(!i||i(e))}));if(0===n.length)return Ne.warning("JAC.".concat(e,"() aborted because there are no valid positions.")),{result:!1,validPositionNames:n};if(n.length!==t.length){var o=ge.diff(t,n);Ne.warning("JAC.".concat(e,"() failed for the following positions"),o)}return{result:!0,validPositionNames:n}}function as(e){!function(e){es.resolved?e():(es.on(Zn.RESOLVED,e),es.on(Zn.READ_TIMEOUT,e),es.on(Zn.API_NOT_FOUND,e))}((function(){!function(e){ts.resolved?e():(ts.on(To.RESOLVED,e),ts.on(To.TIMEOUT,e))}(e)}))}function cs(e,t){gs.trigger(new St(e,Object.assign({},t)))}function us(e){cs(St.POSITION_CONFIG_CHANGED,{positionName:e.target.name,config:e.meta})}function ls(e,t){var i=Object.assign({},t,e.meta),n=e.meta.positionName,o=gs._positions[n].render;e.type===ui.RENDER_COMPLETE?(o.completePosition(n),cs(St.POSITION_RENDER_COMPLETE,i)):e.type===ui.RENDER_FAILED&&(o.abortPosition(n),cs(St.POSITION_RENDER_FAILED,i)),o.positionNames.length<=0&&(o.end(),cs(St.RENDER_COMPLETE,{positionNames:o.completedPositionNames}))}function hs(e){var t=e.service&&e.service.user?e.service.user.regs:void 0;es.resolve(window,t),es.resolved&&ys(),ts.resolved&&_s()}function ds(e,t,i){as((function(){e.isAborted()?Ne.warning("Fetch was aborted for positions",e.abortedPositionNames):(e.start(),cs(St.FETCH_START,{positionNames:e.positionNames}),Xr.fetchAds(e,t,i))}))}function fs(e,t){var i=t.filter((function(t){var i=gs._positions[t];if(i){var n=i.config.client[e].auto,o=ms(t),r=i[e]&&i[e].isPending(t);return n&&!r&&o===(e===Jr.ACTION_NAME)}return!1}));i.length>0&&gs[e](i)}function ps(e){fs(qt.ACTION_NAME,e)}function vs(e){fs(Jr.ACTION_NAME,e)}function ms(e){var t=qr[e];if(!t)return!1;var i=gs._positions[e].config.client.fetch.cacheTTL;return!i||(new Date).getTime()-t.timestamp<i}var gs={_jill:Xr,_scheduler:Qr,_pageObserver:Kr,_pageProtection:$r,_userRegulations:es,_userIdentity:ts,_inspectHandler:is,_adRotationFactory:os,_trackersManager:rs,_instrumentationController:ns,_adData:qr,_positions:{},_positionComponents:{},_config:null,_serverSideConfig:null,_onReadyExecuted:!1,_globalConfigProcessed:!1,processQueue:function(){gs._config?Xr.process():Ne.warning("Jill response can not be processed without a config set.")},get version(){return Yr},setConfig:function(e){var t=this,i=e;this._config=new jt(e,this._serverSideConfig),hs(i);var n=this._config.client.positions;n&&(Object.keys(this._positions).filter((function(e){return!n[e]})).forEach((function(e){return t.destroyPosition(e)})),Object.keys(n).forEach((function(e){var i=t._config.positions[e];t._createPosition(e,i)})));ns.processMetricsEnableStatus(this._config.client),ns.configUpdated(this._config),Qr.applyGlobalRotationConfig(this._config.client.rotation),$r.init(Kr,this,window),function(e){if(e.client&&S.isFunction(e.client.onReady)&&!gs._onReadyExecuted){gs._globalConfigProcessed&&Ne.warning("JAC: Support for onReady hook with JAC.setConfig() has been deprecated and will be removed in the future versions. Please move the code from onReady hook to be executed before JAC.setConfig(). Also, setting the onReady hook inside global JAC_CONFIG variable before JAC is loaded still continues to be supported.");var t=e.client.onReady;try{t()}catch(e){Ne.error("Error while calling JAC_CONFIG.onReady():",e)}gs._onReadyExecuted=!0}}(i),this.processQueue();var o=Object.keys(n);ps(o),this._pageObserver.domLoaded&&vs(o)},getConfig:function(){return this._config?this._config.clone():void 0},updateConfig:function(e,t){if(this._config){var i=gs.getConfig();if(this._config.updateConfigSection(e,t))if(0===e.indexOf(jt.CLIENT_POSITIONS_PROPERTY))if(e===jt.CLIENT_POSITIONS_PROPERTY)gs.setConfig(this._config.input);else{var n=this._config.getPositionNameFromConfigPath(e);Qr.applyGlobalRotationConfig(this._config.client.rotation),function(e,t){var i=gs._config.client.positions[e],n=i.fetch.auto,o=gs._config.positions[e];gs._createPosition(e,o),n&&!t.fetch.auto?ps([e]):i.render.auto&&!t.render.auto&&Kr.domLoaded&&vs([e])}(n,i.client.positions[n])}else 0===e.indexOf(jt.SERVICE_PROPERTY)&&(ns.configUpdated(this._config),hs(this._config.input))}else Ne.warning("JAC Config has not been set.")},createPosition:function(e,t){if(S.isString(e))if(this._config){this._config.updatePosition(e,t);var i=this._config.positions[e];this._createPosition(e,i);var n=[e];ps(n),this._pageObserver.domLoaded&&vs(n)}else Ne.warning("JAC Config has not been set.");else Ne.warning("Non-string positionName found that is ignored: ".concat(e,"."))},_createPosition:function(e,t){var i=this._positions[e];if(i?i.update(t):(this._positions[e]=i=new ut(e,t),i.on(ot.CONFIG_UPDATE,us),cs(St.POSITION_CREATED,{positionName:e})),i.config.client.rotation.enabled&&!Qr.isPositionRegistered(e)){Qr.register(i);var n=this._positionComponents[e];n&&Qr.subscribe(n)}var o=t.client.content;if(o&&o.markup){var r=Vr(t);i.applyAdData(r),qr[e]=r}return i},_createPositionComponent:function(e){var t,i=this,n=e.name,r=new Sn(e,this._pageObserver),s={positionName:n},a=(o(t={},ui.RENDER_START,(function(){cs(St.POSITION_RENDER_START,s)})),o(t,ui.RENDER_COMPLETE,(function(e){ls(e,s)})),o(t,ui.RENDER_FAILED,(function(e){ls(e,s)})),o(t,ui.VIEW_START,(function(){cs(St.POSITION_VIEW_START,s)})),o(t,ui.VIEW_END,(function(){cs(St.POSITION_VIEW_END,s)})),o(t,ui.VIEWABLE,(function(){cs(St.POSITION_VIEWABLE,s)})),o(t,ui.AD_LOAD,(function(){cs(St.AD_LOAD_COMPLETE,s)})),o(t,ui.AD_LOAD_TIMEOUT,(function(){cs(St.AD_LOAD_TIMEOUT,s)})),o(t,ui.NO_AD,(function(){cs(St.NO_AD,s)})),o(t,ui.COLLAPSED,(function(){cs(St.POSITION_COLLAPSED,s)})),o(t,ui.AD_SIZE_CHANGED,(function(e){var t=Object.assign({},s,e.meta);cs(St.AD_SIZE_CHANGED,t)})),o(t,ui.AD_MESSAGE,(function(e){var t=Object.assign({},s,e.meta);cs(St.AD_MESSAGE,t)})),o(t,ui.DESTROY,(function(){Qr.isPositionRegistered(n)&&Qr.unsubscribe(r),c("off"),delete i._positionComponents[n]})),o(t,ui.AD_CLOSED,(function(){cs(St.AD_CLOSED,s)})),o(t,ui.AD_OPENED,(function(){cs(St.AD_OPENED,s)})),t),c=function(e){return Object.keys(a).forEach((function(t){return r[e](t,a[t])}))};return c("on"),Qr.isPositionRegistered(n)&&Qr.subscribe(r),r},destroyPosition:function(e){var t=this._positionComponents[e];t&&t.destroy();var i=this._positions[e];i&&(i.off(ot.CONFIG_UPDATE,us),Qr.isPositionRegistered(e)&&Qr.deregister(i),this.abort([e]),this._config.removePosition(e),delete this._positions[e],delete qr[e])},fetch:function(e){var t=this;if(this._config)if(this._config.isServiceConfigValid()){S.isSet(e)||(e=Object.keys(this._positions));var i=ss("fetch",e,(function(e){var i=t._positions[e],n=t._positionComponents[e],o=i.fetch,r=(new Date).getTime(),s=i.config.client.fetch.minInterval;if(o&&(o.isPending(e)||o.endTime+s>r))return Ne.warning("JAC.fetch() can only be called "+"once per ".concat(s,"ms for ").concat(e," position.")),!1;if(n&&i.config.client.render.auto){var a=n.hasMouseOver,c=n.isExpanded,u=a&&i.config.client.render.abortOnMouseOver,l=c&&i.config.client.render.abortOnExpandedAd;if(u||l)return Ne.warning("JAC.fetch() was ignored for position ".concat(e," because ")+(a?"the user is interacting with the current ad.":"the current ad is expanded.")),!1}return!0})),n=i.result,o=i.validPositionNames;if(n){var r=new qt({positionNames:o});o.forEach((function(e){var i=t._positions[e];i.fetch=r,Qr.isPositionRegistered(e)&&Qr.resetRegistration(i)})),ds(r,this._config)}}else Ne.warning("JAC Config has missing/invalid information.");else Ne.warning("JAC Config has not been set.")},render:function(e){var t=this;if(this._config){S.isSet(e)||(e=Object.keys(qr));var i=ss("render",e,(function(e){var i=t._positions[e];return i&&function(e,t){return ms(e)?!!t.getTargetElement()||(Ne.warning("Target HTML element not found for position ".concat(e,".")),!1):(Ne.warning("No ad data for position ".concat(e,".")),!1)}(e,i.config)})),n=i.result,o=i.validPositionNames;if(n){var r=new Jr({positionNames:o});r.start(),o.forEach((function(e){t._positions[e].render=r})),cs(St.RENDER_START,{positionNames:o}),o.forEach((function(e){var i=t._positions[e];t._positionComponents[e]||(t._positionComponents[e]=t._createPositionComponent(i)),t._positionComponents[e].render(),delete qr[e]}))}}else Ne.warning("JAC Config has not been set.")},abort:function(e){var t=this;S.isSet(e)||(e=Object.keys(this._positions));var i=ss("abort",e),n=i.result,o=i.validPositionNames;n&&o.forEach((function(e){var i=t._positions[e],n=i.fetch;n&&n.isPending(e)&&(n.abortPosition(e),i.fetch=null);var o=i.render;if(o&&o.isPending(e)){o.abortPosition(e),i.render=null;var r=t._positionComponents[e];r&&r.abortRender()}}))},clear:function(e){var t=this;S.isSet(e)||(e=Object.keys(this._positions));var i=ss("clear",e),n=i.result,o=i.validPositionNames;n&&o.forEach((function(e){var i=t._positionComponents[e];i&&i.clearAd()}))},isPositionPending:function(e){var t=this._positions[e];return!(!t||!(t.fetch&&t.fetch.isPending(e)||t.render&&t.render.isPending(e)))},getPending:function(){var e=this;return Object.keys(this._positions).filter((function(t){return e.isPositionPending(t)}))},isPositionFetched:function(e){return ms(e)},getFetched:function(){return Object.keys(qr).filter((function(e){return ms(e)}))},updateMeta:function(e,t,i,n){var o=this;if(!t||S.isString(t)&&!i)Ne.warning("Invalid meta was provided.");else{var r=ss("updateMeta",e,(function(e){return o._positionComponents[e]})),s=r.result,a=r.validPositionNames;s&&a.forEach((function(e){o._config.updateMeta(e,t,i,n)&&o._positionComponents[e].updateMeta()}))}}};function Es(e){Object.keys(e).forEach((function(t){var i=e[t],n=gs._positions[t];if(n.applyAdData(i),!n.rotated&&n.config.client.rotation.enabled&&(Object.prototype.hasOwnProperty.call(gs._config.service.adServer,ze.RAS)||Object.prototype.hasOwnProperty.call(gs._config.service.adServer,ze["1AS"]))){var o=os.createRotationConfig(n.config,i);n.updateRotationConfig(o)}qr[t]=i}))}function ys(){gs._config.setRegulatoryData(es),ts.resolve(gs._config)}function _s(){gs._config.setUserIdentity(ts)}Object.assign(gs,k);var ws=gs;window!==window.top&&"undefined"==typeof JAC_CONFIG?function(e){if(function(e){if(!mt(e)){var t=e.location.host;return[/^.*yahoosandbox\.com$/,/^.*localhost(:\d+)?$/].filter((function(e){return t.match(e)})).length>0}try{return!e.frameElement.src}catch(e){return!0}}(e)){var t=function(e){var t,i,n,o=e.name;if(!o)throw Error("No data provided for the position sandbox.");e.name="";try{e.frameElement.removeAttribute("name")}catch(e){}try{var r=JSON.parse(o);t=r.token,i=r.adData,n=r.safeFrame}catch(e){throw Error("Invalid data provided for the position sandbox.")}if(!t)throw Error("Missing sandbox token.");if(!i||!i.content)throw Error("Missing sandbox ad data.");if(!i.content.markup)throw Error("Missing sandbox ad markup.");if(!i.content.size||!i.content.size.width||!i.content.size.height)throw Error("Missing sandbox ad size.");if(!i.config||!i.config.service||!i.config.client)throw Error("Missing sandbox position config.");var s=i.config.service.sizes,a=s?s.map((function(e){var t=z(e.split("x"),2),i=t[0],n=t[1];return{width:parseInt(i),height:parseInt(n)}})):[],c=i.status!==Be&&!pe.isMobileMomentAd(i)&&(!i.meta||!i.meta.aolSize)&&a.length>1,u=new ut("",i.config);return u.updateContainerType(i.meta||{}),{token:t,adMarkup:i.content.markup,size:i.content.size,detectSize:c,allowedSizes:a,position:u,safeFrameData:n}}(e),i=t.token,n=t.adMarkup,o=t.size,r=t.detectSize,s=t.allowedSizes,a=t.position,c=t.safeFrameData,u=a.config;lt=r,ht(i,e,u.client.nestedIframe),function(e,t){e.JAC={version:l("1.3.0")!==A?"1.3.0":"0.0.0",sandbox:new Te(st,t)}}(e,u),e.JAC.sandbox.on(me.INIT_CALLED,(function(t){lt=!1,vt(a,!!t.meta.ratio,e)})),a.containerType===Ze&&function(e,t,i){st.listen(),e.$sf={ext:new Ue(st,t,i,e)},e.Y={SandBox:{vendor:new Ge(st)}}}(e,u,c),vt(a,!1,e),g.addPageLoadListener((function(){return dt({positionConfig:u,initialWidth:o.width,initialHeight:o.height,allowedSizes:s})})),function(e,t){e.document.write("<div>".concat(t,"</div>"))}(e,n),st.send(new V({topic:V.topic.WRITE_COMPLETE}))}else Ne.error("Invalid context detected")}(window):(Object.assign(ws,{PageObserver:U,PageEvent:m}),window.JAC=ws,function(e){Xr.on(zt.RESPONSE_PROCESSED,(function(e){var t=e.meta.response,i=e.meta.fetchAction;i.end();var n=zr(i.completedPositionNames,t,gs._config),o=Object.keys(n);Es(n),cs(St.FETCH_COMPLETE,{positionNames:o,response:{positions:n,adServer:t.adServer,service:t.service}}),Kr.domLoaded&&vs(o)})),Xr.on(zt.FETCH_TIMEOUT,(function(e){var t=Wr(e.meta.positionNames,gs._config),i=Object.keys(t);Es(t),cs(St.FETCH_TIMEOUT,e.meta),Kr.domLoaded&&vs(i)})),Xr.on(zt.FETCH_ERROR,(function(e){cs(St.FETCH_ERROR,e.meta)})),Qr.init(),Qr.on(Ln.ROTATION,(function(e){var t=e.meta.positionNames,i=new qt({positionNames:t});t.forEach((function(e){var t=gs._positions[e],n=gs._positionComponents[e].lastAdSize;t.rotated||(t.rotated=!0,t.alias=os.getRotationAliasBasedOnSize(t.adData,n)),i.optionsPerPosition[e]={fetchSize:n,allowedSizes:t.adData.config.service.sizes},t.fetch=i,cs(St.POSITION_ROTATE,{positionName:e})})),ds(i,gs._config)})),es.on(Zn.API_NOT_FOUND,ys),es.on(Zn.RESOLVED,ys),es.on(Zn.READ_TIMEOUT,ys),es.on(Zn.UPDATED,ys),ts.on(To.RESOLVED,_s),ts.on(To.TIMEOUT,_s),ts.on(To.UPDATED,_s),is.activate(e,gs),ns.init(gs),function(e){var t=e.document,i="currentScript"in t?t.currentScript:t.querySelector("script[data-jac-ssc]");try{var n=i&&i.dataset.jacSsc;n&&(gs._serverSideConfig=JSON.parse(n))}catch(e){Ne.error("Error processing server-side config",e)}}(e),function(e){e.JAC_CONFIG&&gs.setConfig(e.JAC_CONFIG),gs._globalConfigProcessed=!0}(e),Kr.on(m.DOM_LOADED,(function(){vs(Object.keys(gs._adData))})),Kr.on(m.LOADED,(function(){rs.injectTrackers(gs._config?gs._config.client.trackers:null)}))}(window))}()}();